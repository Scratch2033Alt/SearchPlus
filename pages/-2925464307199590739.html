<!DOCTYPE html>
<html typeof="bibo:Document " prefix="bibo: http://purl.org/ontology/bibo/ w3p: http://www.w3.org/2001/02pd/rec54#" lang="en-US">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="dc:language" content="en" lang="">
  <style>
    /*

github.com style (c) Vasily Polovnyov <vast@whiteants.net>

*/

    .hljs {
      display: block;
      overflow-x: auto;
      padding: 0.5em;
      color: #333;
      background: #f8f8f8;
    }

    .hljs-comment,
    .hljs-quote {
      color: #998;
      font-style: italic;
    }

    .hljs-keyword,
    .hljs-selector-tag,
    .hljs-subst {
      color: #333;
      font-weight: bold;
    }

    .hljs-number,
    .hljs-literal,
    .hljs-variable,
    .hljs-template-variable,
    .hljs-tag .hljs-attr {
      color: #008080;
    }

    .hljs-string,
    .hljs-doctag {
      color: #d14;
    }

    .hljs-title,
    .hljs-section,
    .hljs-selector-id {
      color: #900;
      font-weight: bold;
    }

    .hljs-subst {
      font-weight: normal;
    }

    .hljs-type,
    .hljs-class .hljs-title {
      color: #458;
      font-weight: bold;
    }

    .hljs-tag,
    .hljs-name,
    .hljs-attribute {
      color: #000080;
      font-weight: normal;
    }

    .hljs-regexp,
    .hljs-link {
      color: #009926;
    }

    .hljs-symbol,
    .hljs-bullet {
      color: #990073;
    }

    .hljs-built_in,
    .hljs-builtin-name {
      color: #0086b3;
    }

    .hljs-meta {
      color: #999;
      font-weight: bold;
    }

    .hljs-deletion {
      background: #fdd;
    }

    .hljs-addition {
      background: #dfd;
    }

    .hljs-emphasis {
      font-style: italic;
    }

    .hljs-strong {
      font-weight: bold;
    }
  </style>
  <title>SHACL Advanced Features</title>



  <style>
    pre {
      tab-size: 3;
      -moz-tab-size: 3;
      /* Code for Firefox */
      -o-tab-size: 3;
      /* Code for Opera */
      word-wrap: normal;
    }

    th {
      text-align: left;
    }

    table.rule {
      background-color: #EBEBE0;
    }

    table.rule td {
      text-align: center;
    }

    td.up {
      border-bottom: 1px solid black;
    }

    td {
      vertical-align: top;
    }

    .algorithm {
      background: #fafafc;
      border-left-style: solid;
      border-left-width: .5em;
      border-color: #c0c0c0;
      margin-bottom: 16px;
      padding: 8px;
    }

    .arg {
      font-weight: bold;
      color: #000080;
    }

    .def {
      background: #fcfcfc;
      border-left-style: solid;
      border-left-width: .5em;
      border-color: #c0c0c0;
      margin-bottom: 16px;
    }

    .def-sparql {}

    .def-sparql-body {
      margin-top: 0px;
      margin-bottom: 0px;
    }

    .def-text {}

    .def-text-body {}

    .def-header {
      color: #a0a0a0;
      font-size: 16px;
      padding-bottom: 8px;
    }

    .diagram-class {
      border: 1px solid black;
      border-radius: 4px;
      width: 360px;
    }

    .diagram-class-name {
      font-size: 16px;
      font-weight: bold;
      text-align: center;
    }

    .diagram-class-properties {
      border-top: 1px solid black;
    }

    .diagram-class-properties-start {
      padding: 8px;
    }

    .diagram-class-properties-section {
      border-top: 1px dashed #808080;
      padding: 8px;
    }

    .focus-node-selected {
      color: blue;
    }

    .focus-node-error {
      color: red;
    }

    .triple-can-be-skipped {
      color: grey;
    }

    .focus-node-error {
      color: red;
    }

    .target-can-be-skipped {
      color: darkslategray;
      font-style: italic;
    }

    .component-class {
      font-weight: bold;
      font-size: 16px;
    }

    .parameter-context {
      font-weight: bold;
      font-size: 16px;
    }

    .parameters {
      font-weight: bold;
      font-size: 16px;
    }

    .part-header {
      font-weight: bold;
    }

    .syntax {
      border-left-style: solid;
      border-left-width: .5em;
      border-color: #d0d0d0;
      margin-bottom: 16px;
      padding: .5em 1em;
      background-color: #f6f6f6;
    }

    .syntax-rule-id {
      padding-right: 10px;
    }

    .syntax-rule-id-a {
      white-space: nowrap;
    }

    .validator-id-a {
      font-weight: bold;
      white-space: nowrap;
    }

    .term {
      font-style: italic;
    }

    .term-def-header {
      font-style: italic;
      font-weight: bold;
    }

    .term-table {
      border-collapse: collapse;
      border-color: #000000;
      margin: 16px;
    }

    .term-table td,
    th {
      border-width: 1px;
      border-style: solid;
      padding: 5px;
    }

    .todo {
      color: red;
    }
    /* example pre taken / adapted from R2RML */

    pre.example-shapes,
    pre.example-data,
    pre.example-results,
    pre.example-other,
    pre.example-sparql {
      margin-left: 0;
      padding: 0 2em;
      margin-top: 1.5em;
      padding: 1em;
      white-space: pre !important;
    }

    pre.example-shapes:before,
    pre.example-data:before,
    pre.example-results:before,
    pre.example-other:before,
    pre.example-sparql:before {
      background: white;
      display: block;
      font-family: sans-serif;
      margin: -1em 0 0.4em -1em;
      padding: 0.2em 1em;
    }

    pre.example-shapes {
      background: #deb;
    }

    pre.example-shapes,
    pre.example-shapes:before {
      border: 1px solid #bbb;
    }

    pre.example-shapes:before {
      color: #888;
      content: "Example shapes graph";
      width: 13em;
    }

    pre.example-data {
      background: #eeb;
    }

    pre.example-data,
    pre.example-data:before {
      border: 1px solid #cc9;
    }

    pre.example-data:before {
      color: #996;
      content: "Example data graph";
      width: 13em;
    }

    pre.example-results:before {
      color: #797;
      content: "Example validation results";
      width: 13em;
    }

    pre.example-other {
      background: #bed;
    }

    pre.example-other,
    pre.example-other:before {
      border: 1px solid #ddd;
    }

    pre.example-other:before {
      color: #888;
      content: "Example";
      width: 13em;
    }

    pre.example-sparql {
      background: #bed;
    }

    pre.example-sparql,
    pre.example-sparql:before {
      border: 1px solid #ddd;
    }

    pre.example-sparql:before {
      color: #888;
      content: "Example SPARQL";
      width: 13em;
    }

    .example-results {
      background: #edb;
    }

    .example-results,
    .example-results:before,
    .example-results th,
    .example-results td {
      border: 1px solid #cca;
    }
    /* our syntax menu for switching */

    div.syntaxmenu {
      border: 1px dotted black;
      padding: 0.5em;
      margin: 1em;
    }

    @media print {
      div.syntaxmenu {
        display: none;
      }
    }
  </style>
  <style id="respec-mainstyle">
    /*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/
    /* Override code highlighter background */

    .hljs {
      background: transparent !important;
    }
    /* --- INLINES --- */

    em.rfc2119 {
      text-transform: lowercase;
      font-style: normal;
      color: #900;
    }

    h1 abbr,
    h2 abbr,
    h3 abbr,
    h4 abbr,
    h5 abbr,
    h6 abbr,
    a abbr {
      border: none;
    }

    dfn {
      font-weight: bold;
    }

    a.internalDFN {
      color: inherit;
      border-bottom: 1px solid #99c;
      text-decoration: none;
    }

    a.externalDFN {
      color: inherit;
      border-bottom: 1px dotted #ccc;
      text-decoration: none;
    }

    a.bibref {
      text-decoration: none;
    }

    cite .bibref {
      font-style: normal;
    }

    code {
      color: #C83500;
    }

    th code {
      color: inherit;
    }
    /* --- TOC --- */

    .toc a,
    .tof a {
      text-decoration: none;
    }

    a .secno,
    a .figno {
      color: #000;
    }

    ul.tof,
    ol.tof {
      list-style: none outside none;
    }

    .caption {
      margin-top: 0.5em;
      font-style: italic;
    }
    /* --- TABLE --- */

    table.simple {
      border-spacing: 0;
      border-collapse: collapse;
      border-bottom: 3px solid #005a9c;
    }

    .simple th {
      background: #005a9c;
      color: #fff;
      padding: 3px 5px;
      text-align: left;
    }

    .simple th[scope="row"] {
      background: inherit;
      color: inherit;
      border-top: 1px solid #ddd;
    }

    .simple td {
      padding: 3px 10px;
      border-top: 1px solid #ddd;
    }

    .simple tr:nth-child(even) {
      background: #f0f6ff;
    }
    /* --- DL --- */

    .section dd>p:first-child {
      margin-top: 0;
    }

    .section dd>p:last-child {
      margin-bottom: 0;
    }

    .section dd {
      margin-bottom: 1em;
    }

    .section dl.attrs dd,
    .section dl.eldef dd {
      margin-bottom: 0;
    }

    #issue-summary>ul,
    .respec-dfn-list {
      column-count: 2;
    }

    #issue-summary li,
    .respec-dfn-list li {
      list-style: none;
    }

    @media print {
      .removeOnSave {
        display: none;
      }
    }
  </style>
  <link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/W3C-WG-NOTE.css">
  <link rel="canonical" href="https://www.w3.org/TR/shacl-af/">
  <meta name="generator" content="ReSpec 13.1.0">
  <script id="initialUserConfig" type="application/json">
    {
      "localBiblio":
      {
        "shacl-js":
        {
          "title": "SHACL JavaScript Extensions",
          "authors": [
            "Holger Knublauch",
            "Pano Maria"
          ],
          "href": "https://www.w3.org/TR/shacl-js/",
          "status": "WG-NOTE",
          "publisher": "W3C"
        }
      },
      "specStatus": "FPWD-NOTE",
      "preProcess": [
        null
      ],
      "edDraftURI": "https://w3c.github.io/data-shapes/shacl-af/",
      "shortName": "shacl-af",
      "editors": [
      {
        "name": "Holger Knublauch",
        "url": "http://knublauch.com/",
        "company": "TopQuadrant, Inc.",
        "companyURL": "http://topquadrant.com/",
        "w3cid": 46500
      },
      {
        "name": "Dean Allemang",
        "url": "http://workingontologist.com",
        "company": "Working Ontologist LLC.",
        "companyURL": "http://workingontologist.com"
      },
      {
        "name": "Simon Steyskal",
        "url": "http://steyskal.info/",
        "company": "WU Vienna/Siemens AG",
        "w3cid": 73545
      }],
      "publishDate": "2017-06-08",
      "wg": "RDF Data Shapes Working Group",
      "wgURI": "https://www.w3.org/2014/data-shapes/",
      "wgPublicList": "public-rdf-shapes",
      "wgPatentURI": "https://www.w3.org/2004/01/pp-impl/73865/status",
      "noHighlightCSS": true
    }
  </script>
</head>
<body aria-busy="false" class="h-entry toc-inline" id="respecDocument">
  <div class="head" role="contentinfo" id="respecHeader">
    <p>
      <a class="logo" href="https://www.w3.org/"><img src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" alt="W3C" width="72" height="48"></a>
    </p>
    <h1 class="title p-name" id="title" property="dcterms:title">SHACL Advanced Features</h1>
    <h2 id="w3c-working-group-note-08-june-2017"><abbr title="World Wide Web Consortium">W3C</abbr> Working Group Note <time property="dcterms:issued" class="dt-published" datetime="2017-06-08">08 June 2017</time></h2>
    <dl>
      <dt>This version:</dt>
      <dd><a class="u-url" href="https://www.w3.org/TR/2017/NOTE-shacl-af-20170608/">https://www.w3.org/TR/2017/NOTE-shacl-af-20170608/</a></dd>
      <dt>Latest published version:</dt>
      <dd><a href="https://www.w3.org/TR/shacl-af/">https://www.w3.org/TR/shacl-af/</a></dd>
      <dt>Latest editor's draft:</dt>
      <dd><a href="https://w3c.github.io/data-shapes/shacl-af/">https://w3c.github.io/data-shapes/shacl-af/</a></dd>
      <dt>Editors:</dt>
      <dd class="p-author h-card vcard" property="bibo:editor" resource="_:editor0" data-editor-id="46500"><span property="rdf:first" typeof="foaf:Person"><meta property="foaf:name" content="Holger Knublauch"><a class="u-url url p-name fn" property="foaf:homepage" href="http://knublauch.com/">Holger Knublauch</a>, <a property="foaf:workplaceHomepage" class="p-org org h-org h-card" href="http://topquadrant.com/">TopQuadrant, Inc.</a></span>
        <span property="rdf:rest" resource="_:editor1"></span>
      </dd>
      <dd class="p-author h-card vcard" resource="_:editor1" data-editor-id="46500"><span property="rdf:first" typeof="foaf:Person"><meta property="foaf:name" content="Dean Allemang"><a class="u-url url p-name fn" property="foaf:homepage" href="http://workingontologist.com">Dean Allemang</a>, <a property="foaf:workplaceHomepage" class="p-org org h-org h-card" href="http://workingontologist.com">Working Ontologist LLC.</a></span>
        <span property="rdf:rest" resource="_:editor2"></span>
      </dd>
      <dd class="p-author h-card vcard" resource="_:editor2" data-editor-id="73545"><span property="rdf:first" typeof="foaf:Person"><meta property="foaf:name" content="Simon Steyskal"><a class="u-url url p-name fn" property="foaf:homepage" href="http://steyskal.info/">Simon Steyskal</a>, WU Vienna/Siemens AG</span>
        <span property="rdf:rest" resource="rdf:nil"></span>
      </dd>

    </dl>
    <p class="copyright">
      <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2017

      <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
      <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
      <a href="https://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>).
      <abbr title="World Wide Web Consortium">W3C</abbr> <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
      <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
      <a rel="license" href="https://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.
    </p>
    <hr title="Separator for header">
  </div>

  <section id="abstract" class="introductory" property="dc:abstract">
    <h2 id="h-abstract" resource="#h-abstract"><span property="xhv:role" resource="xhv:heading">Abstract</span></h2>
    <p>
      This document describes advanced features of the Shapes Constraint Language (SHACL) [<cite><a class="bibref" href="#bib-shacl">shacl</a></cite>] including features to define custom targets, annotation properties, user-defined functions, node expressions and rules. While many of these features rely on SPARQL, they also define extension points that can be used by other implementation languages.
    </p>
  </section>

  <section id="sotd" class="introductory">
    <h2 id="h-sotd" resource="#h-sotd"><span property="xhv:role" resource="xhv:heading">Status of This Document</span></h2>
    <p>
      <em>This section describes the status of this document at the time of its publication. Other documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision of this technical report can be found in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at https://www.w3.org/TR/.</em>
    </p>

    <p>
      Future revisions of this document may be produced by a SHACL <abbr title="World Wide Web Consortium">W3C</abbr> Community Group.
    </p>

    <p>
      This document was published by the <a href="https://www.w3.org/2014/data-shapes/">RDF Data Shapes Working Group</a> as a First Public Working Group Note. Comments regarding this document are welcome. Please send them to
      <a href="mailto:public-rdf-shapes@w3.org">public-rdf-shapes@w3.org</a> (<a href="mailto:public-rdf-shapes-request@w3.org?subject=subscribe">subscribe</a>,
      <a href="https://lists.w3.org/Archives/Public/public-rdf-shapes/">archives</a>).
    </p>
    <p>
      Publication as a Working Group Note does not imply endorsement by the <abbr title="World Wide Web Consortium">W3C</abbr> Membership. This is a draft document and may be updated, replaced or obsoleted by other documents at any time. It is inappropriate to cite this document as other than work in progress.
    </p>
    <p>
      This document was produced by a group operating under the
      <a id="sotd_patent" property="w3p:patentRules" href="https://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <abbr title="World Wide Web Consortium">W3C</abbr> Patent
            Policy</a>.
      <abbr title="World Wide Web Consortium">W3C</abbr> maintains a <a href="https://www.w3.org/2004/01/pp-impl/73865/status" rel="disclosure">public list of any patent
              disclosures</a> made in connection with the deliverables of the group; that page also includes instructions for disclosing a patent. An individual who has actual knowledge of a patent which the individual believes contains
      <a href="https://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
            Claim(s)</a> must disclose the information in accordance with
      <a href="https://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
            6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
    </p>
    <p>This document is governed by the <a id="w3c_process_revision" href="https://www.w3.org/2017/Process-20170301/">1 March 2017 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
    </p>


  </section>
  <nav id="toc">
    <h2 class="introductory" id="table-of-contents" resource="#table-of-contents"><span property="xhv:role" resource="xhv:heading">Table of Contents</span></h2>
    <ol class="toc" role="directory">
      <li class="tocline"><a href="#intro" class="tocxref"><span class="secno">1. </span>Introduction</a></li>
      <li class="tocline"><a href="#conformance" class="tocxref"><span class="secno">2. </span>Conformance</a></li>
      <li class="tocline"><a href="#targets" class="tocxref"><span class="secno">3. </span>Custom Targets</a>
        <ol class="toc">
          <li class="tocline"><a href="#SPARQLTarget" class="tocxref"><span class="secno">3.1 </span>SPARQL-based Targets</a></li>
          <li class="tocline"><a href="#SPARQLTargetType" class="tocxref"><span class="secno">3.2 </span>SPARQL-based Target Types</a></li>
        </ol>
      </li>
      <li class="tocline"><a href="#sparql-constraints-annotations" class="tocxref"><span class="secno">4. </span>Annotation Properties</a></li>
      <li class="tocline"><a href="#functions" class="tocxref"><span class="secno">5. </span>SHACL Functions</a>
        <ol class="toc">
          <li class="tocline"><a href="#functions-example" class="tocxref"><span class="secno">5.1 </span>An Example SHACL Function</a></li>
          <li class="tocline"><a href="#function-parameters" class="tocxref"><span class="secno">5.2 </span>Function Parameters</a></li>
          <li class="tocline"><a href="#function-returnType" class="tocxref"><span class="secno">5.3 </span>sh:returnType</a></li>
          <li class="tocline"><a href="#SPARQLFunction" class="tocxref"><span class="secno">5.4 </span>SPARQL-based Functions</a></li>
        </ol>
      </li>
      <li class="tocline"><a href="#node-expressions" class="tocxref"><span class="secno">6. </span>Node Expressions</a>
        <ol class="toc">
          <li class="tocline"><a href="#node-expressions-focus" class="tocxref"><span class="secno">6.1 </span>Focus Node Expressions</a></li>
          <li class="tocline"><a href="#node-expressions-constant" class="tocxref"><span class="secno">6.2 </span>Constant Term Expressions</a></li>
          <li class="tocline"><a href="#node-expressions-filter-shape" class="tocxref"><span class="secno">6.3 </span>Filter Shape Expressions</a></li>
          <li class="tocline"><a href="#node-expressions-function" class="tocxref"><span class="secno">6.4 </span>Function Expressions</a></li>
          <li class="tocline"><a href="#node-expressions-path" class="tocxref"><span class="secno">6.5 </span>Path Expressions</a></li>
          <li class="tocline"><a href="#intersection" class="tocxref"><span class="secno">6.6 </span>Intersection Expressions</a></li>
          <li class="tocline"><a href="#union" class="tocxref"><span class="secno">6.7 </span>Union Expressions</a></li>
        </ol>
      </li>
      <li class="tocline"><a href="#ExpressionConstraintComponent" class="tocxref"><span class="secno">7. </span>Expression Constraints</a></li>
      <li class="tocline"><a href="#rules" class="tocxref"><span class="secno">8. </span>SHACL Rules</a>
        <ol class="toc">
          <li class="tocline"><a href="#rules-examples" class="tocxref"><span class="secno">8.1 </span>Examples of SHACL Rules</a></li>
          <li class="tocline"><a href="#rules-syntax" class="tocxref"><span class="secno">8.2 </span>General Syntax of SHACL Rules</a>
            <ol class="toc">
              <li class="tocline"><a href="#condition" class="tocxref"><span class="secno">8.2.1 </span>sh:condition</a></li>
              <li class="tocline"><a href="#rules-order" class="tocxref"><span class="secno">8.2.2 </span>sh:order</a></li>
              <li class="tocline"><a href="#deactivated" class="tocxref"><span class="secno">8.2.3 </span>sh:deactivated</a></li>
            </ol>
          </li>
          <li class="tocline"><a href="#Rules" class="tocxref"><span class="secno">8.3 </span>The sh:Rules Entailment Regime</a></li>
          <li class="tocline"><a href="#rules-execution" class="tocxref"><span class="secno">8.4 </span>General Execution Instructions for SHACL Rules</a></li>
          <li class="tocline"><a href="#TripleRule" class="tocxref"><span class="secno">8.5 </span>Triple Rules</a></li>
          <li class="tocline"><a href="#SPARQLRule" class="tocxref"><span class="secno">8.6 </span>SPARQL Rules</a></li>
        </ol>
      </li>
      <li class="tocline"><a href="#syntax-rules" class="tocxref"><span class="secno">A. </span>Summary of Syntax Rules from this Document</a></li>
      <li class="tocline"><a href="#security" class="tocxref"><span class="secno">B. </span>Security and Privacy Considerations</a></li>
      <li class="tocline"><a href="#ack" class="tocxref"><span class="secno">C. </span>Acknowledgements</a></li>
      <li class="tocline"><a href="#references" class="tocxref"><span class="secno">D. </span>References</a>
        <ol class="toc">
          <li class="tocline"><a href="#normative-references" class="tocxref"><span class="secno">D.1 </span>Normative references</a></li>
          <li class="tocline"><a href="#informative-references" class="tocxref"><span class="secno">D.2 </span>Informative references</a></li>
        </ol>
      </li>
    </ol>
  </nav>

  <section class="introductory" typeof="bibo:Chapter" resource="#document-conventions" property="bibo:hasPart">
    <h2 id="document-conventions" resource="#document-conventions"><span property="xhv:role" resource="xhv:heading">Document Conventions</span></h2>
    <p>
      Some examples in this document use Turtle [<cite><a class="bibref" href="#bib-turtle">turtle</a></cite>]. The reader is expected to be familiar with SHACL [<cite><a class="bibref" href="#bib-shacl">shacl</a></cite>] and SPARQL [<cite><a class="bibref" href="#bib-sparql11-query">sparql11-query</a></cite>].
    </p>
    <p>
      Within this document, the following namespace prefix bindings are used:
    </p>
    <table class="term-table">
      <tbody>
        <tr>
          <th>Prefix</th>
          <th>Namespace</th>
        </tr>
        <tr>
          <td><code>rdf:</code></td>
          <td><code>http://www.w3.org/1999/02/22-rdf-syntax-ns#</code></td>
        </tr>
        <tr>
          <td><code>rdfs:</code></td>
          <td><code>http://www.w3.org/2000/01/rdf-schema#</code></td>
        </tr>
        <tr>
          <td><code>sh:</code></td>
          <td><code>http://www.w3.org/ns/shacl#</code></td>
        </tr>
        <tr>
          <td><code>xsd:</code></td>
          <td><code>http://www.w3.org/2001/XMLSchema#</code></td>
        </tr>
        <tr>
          <td><code>ex:</code></td>
          <td><code>http://example.com/ns#</code></td>
        </tr>
      </tbody>
    </table>
    <p>
      Throughout the document, color-coded boxes containing RDF graphs in Turtle will appear. These fragments of Turtle documents use the prefix bindings given above.
    </p>
    <pre class="example-shapes"># This box represents a shapes graph
&lt;s&gt; &lt;p&gt; &lt;o&gt; .</pre>

    <pre class="example-js">// This box contains JavaScript code</pre>

    <pre class="example-data"># This box represents a data graph.</pre>

    <pre class="example-results"># This box represents an output results graph</pre>

    <p>
      Formal definitions appear in blue boxes:
    </p>
    <div class="def def-sparql">
      <div class="def-header">TEXTUAL DEFINITIONS</div>
      <pre class="def-sparql-body"># This box contains textual definitions. </pre>
    </div>

    <p class="syntax">
      Grey boxes such as this include syntax rules that apply to the shapes graph.
    </p>

    <p>
      <code>true</code> denotes the RDF term <code>"true"^^xsd:boolean</code>.
      <code>false</code> denotes the RDF term <code>"false"^^xsd:boolean</code>.
    </p>
  </section>

  <section class="introductory" typeof="bibo:Chapter" resource="#terminology" property="bibo:hasPart">
    <h2 id="terminology" resource="#terminology"><span property="xhv:role" resource="xhv:heading">Terminology</span></h2>
    <p>
      The terminology used throughout this document is consistent with the definitions in the main SHACL [<cite><a class="bibref" href="#bib-shacl">shacl</a></cite>] specification, which references terms from RDF [<cite><a class="bibref" href="#bib-rdf11-concepts">rdf11-concepts</a></cite>]. This includes the terms
      <dfn data-dfn-type="dfn" id="dfn-binding"><a href="https://www.w3.org/TR/shacl/#dfn-binding">binding</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-blank-node"><a href="https://www.w3.org/TR/shacl/#dfn-blank-node">blank node</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-conformance"><a href="https://www.w3.org/TR/shacl/#dfn-conforms">conformance</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-constraint"><a href="https://www.w3.org/TR/shacl/#dfn-constraint">constraint</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-constraint-component"><a href="https://www.w3.org/TR/shacl/#dfn-constraint-component">constraint component</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-data-graph"><a href="https://www.w3.org/TR/shacl/#dfn-data-graph">data graph</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-datatype"><a href="https://www.w3.org/TR/shacl/#dfn-datatype">datatype</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-failure"><a href="https://www.w3.org/TR/shacl/#dfn-failure">failure</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-focus-node"><a href="https://www.w3.org/TR/shacl/#dfn-focus-node">focus node</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-rdf-graph"><a href="https://www.w3.org/TR/shacl/#dfn-rdf-graph">RDF graph</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-ill-formed"><a href="https://www.w3.org/TR/shacl/#dfn-ill-formed">ill-formed</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-iri"><a href="https://www.w3.org/TR/shacl/#dfn-iri">IRI</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-literal"><a href="https://www.w3.org/TR/shacl/#dfn-literal">literal</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-local-name"><a href="https://www.w3.org/TR/shacl/#dfn-local-name">local name</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-member"><a href="https://www.w3.org/TR/shacl/#dfn-members">member</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-node"><a href="https://www.w3.org/TR/shacl/#dfn-node">node</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-node-shape"><a href="https://www.w3.org/TR/shacl/#dfn-node-shape">node shape</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-object"><a href="https://www.w3.org/TR/shacl/#dfn-object">object</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-parameter"><a href="https://www.w3.org/TR/shacl/#dfn-parameters">parameter</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-pre-binding"><a href="https://www.w3.org/TR/shacl/#pre-binding">pre-binding</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-predicate"><a href="https://www.w3.org/TR/shacl/#dfn-predicate">predicate</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-property-path"><a href="https://www.w3.org/TR/shacl/#dfn-shacl-property-path">property path</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-property-shape"><a href="https://www.w3.org/TR/shacl/#dfn-property-shape">property shape</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-rdf-term"><a href="https://www.w3.org/TR/shacl/#dfn-rdf-term">RDF term</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-shacl-instance"><a href="https://www.w3.org/TR/shacl/#dfn-shacl-instance">SHACL instance</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-shacl-list"><a href="https://www.w3.org/TR/shacl/#dfn-shacl-list">SHACL list</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-shacl-subclass"><a href="https://www.w3.org/TR/shacl/#dfn-shacl-subclass">SHACL subclass</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-shape"><a href="https://www.w3.org/TR/shacl/#dfn-shape">shape</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-shapes-graph"><a href="https://www.w3.org/TR/shacl/#dfn-shapes-graph">shapes graph</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-solution"><a href="https://www.w3.org/TR/shacl/#dfn-solution">solution</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-subject"><a href="https://www.w3.org/TR/shacl/#dfn-subject">subject</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-target"><a href="https://www.w3.org/TR/shacl/#dfn-target">target</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-triple"><a href="https://www.w3.org/TR/shacl/#dfn-rdf-triple">triple</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-validation"><a href="https://www.w3.org/TR/shacl/#dfn-validation">validation</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-validation-report"><a href="https://www.w3.org/TR/shacl/#dfn-validation-report">validation report</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-validation-result"><a href="https://www.w3.org/TR/shacl/#dfn-validation-results">validation result</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-validator"><a href="https://www.w3.org/TR/shacl/#dfn-validators">validator</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-value"><a href="https://www.w3.org/TR/shacl/#dfn-value">value</a></dfn>,
      <dfn data-dfn-type="dfn" id="dfn-value-node"><a href="https://www.w3.org/TR/shacl/#dfn-value-nodes">value node</a></dfn>.
    </p>
  </section>

  <section id="intro" typeof="bibo:Chapter" resource="#intro" property="bibo:hasPart">
    <!--OddPage-->
    <h2 id="h-intro" resource="#h-intro"><span property="xhv:role" resource="xhv:heading"><span class="secno">1. </span>Introduction</span>
    </h2>
    <p>
      The SHACL specification [<cite><a class="bibref" href="#bib-shacl">shacl</a></cite>] is divided into SHACL Core and SHACL-SPARQL:
    </p>
    <ul>
      <li>
        <strong>SHACL Core</strong> consists of frequently needed features for the representation of <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shapes</a>,
        <a href="#dfn-constraint" class="internalDFN" data-link-type="dfn">constraints</a> and <a href="#dfn-target" class="internalDFN" data-link-type="dfn">targets</a>.
      </li>
      <li>
        <strong>SHACL-SPARQL</strong> consists of all features of SHACL Core plus the expressive power of SPARQL-based <a href="#dfn-constraint" class="internalDFN" data-link-type="dfn">constraints</a> and an extension mechanism to declare new <a href="#dfn-constraint-component" class="internalDFN" data-link-type="dfn">constraint components</a>.
      </li>
    </ul>
    <p>
      This document extends the functionality of SHACL by defining RDF vocabularies to cover the following features:
    </p>
    <ul>
      <li><b><a href="#dfn-custom-targets" class="internalDFN" data-link-type="dfn">Custom Targets</a></b> - add flexibility to selecting the <a href="#dfn-focus-node" class="internalDFN" data-link-type="dfn">focus nodes</a> of <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shapes</a></li>
      <li><b><a href="#dfn-annotation-properties" class="internalDFN" data-link-type="dfn">Annotation Properties</a></b> - can create extra values in validation reports</li>
      <li><b><a href="#dfn-shacl-functions" class="internalDFN" data-link-type="dfn">SHACL Functions</a></b> - encapsulate complex operations into reusable building blocks</li>
      <li><b><a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">Node Expressions</a></b> - describe how to derive sets of <a href="#dfn-node" class="internalDFN" data-link-type="dfn">nodes</a></li>
      <li><b><a href="#dfn-expression-constraints" class="internalDFN" data-link-type="dfn">Expression Constraints</a></b> - enable constraint checks based on node expressions</li>
      <li><b><a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">SHACL Rules</a></b> - enable deriving new <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a> from existing ones</li>
    </ul>
    <p>
      Taken together or individually, these features greatly extend the application scenarios of SHACL, and SHACL-SPARQL in particular.
    </p>
  </section>

  <section id="conformance" typeof="bibo:Chapter" resource="#conformance" property="bibo:hasPart">
    <!--OddPage-->
    <h2 id="h-conformance" resource="#h-conformance"><span property="xhv:role" resource="xhv:heading"><span class="secno">2. </span>Conformance</span>
    </h2>
    <p>
      As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.
    </p>
    <p id="respecRFC2119">The key words <em class="rfc2119">MUST</em> and <em class="rfc2119">SHOULD</em> are to be interpreted as described in [<cite><a class="bibref" href="#bib-RFC2119">RFC2119</a></cite>].
    </p>

    <p>
      Some of the features presented here (including <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expressions</a>, <a href="#dfn-expression-constraints" class="internalDFN" data-link-type="dfn">expression constraints</a> and <a href="#dfn-triple-rules" class="internalDFN" data-link-type="dfn">triple rules</a>) do not necessarily require a SPARQL processor and could be used as extensions of pure SHACL Core implementations. Other features (including <a href="#SPARQLTargetType">custom target types</a>, <a href="#dfn-shacl-functions" class="internalDFN" data-link-type="dfn">SHACL functions</a>, and general <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">SHACL rules</a>) define extension mechanisms that can also be used with other languages than SPARQL, such as JavaScript (as defined by the SHACL-JS document [<cite><a class="bibref" href="#bib-shacl-js">shacl-js</a></cite>]).
    </p>
    <p>
      A SHACL-SPARQL processor that also supports all features defined in this document and is called an <dfn data-dfn-type="dfn" id="dfn-advanced-shacl-sparql">Advanced SHACL-SPARQL</dfn> processor.
    </p>
  </section>

  <section id="targets" typeof="bibo:Chapter" resource="#targets" property="bibo:hasPart">
    <!--OddPage-->
    <h2 id="h-targets" resource="#h-targets"><span property="xhv:role" resource="xhv:heading"><span class="secno">3. </span>Custom Targets</span>
    </h2>
    <p>
      In general, <a href="#dfn-target" class="internalDFN" data-link-type="dfn">targets</a> define a mechanism that is used by SHACL engines to determine the <a href="#dfn-focus-node" class="internalDFN" data-link-type="dfn">focus nodes</a> that should be validated against a given <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a>. SHACL Core [<cite><a class="bibref" href="#bib-shacl">shacl</a></cite>] defines a fixed set of Core <a href="#dfn-target" class="internalDFN" data-link-type="dfn">targets</a> by means of properties such as <code>sh:targetClass</code>. These Core targets were designed to cover a large number of use cases while retaining a simple declarative data model. However, in some use cases, these Core targets are not sufficient. For example it is impossible to state that a shape should apply only to a subset of instances of a class, e.g. persons born in the USA. Neither is it possible to state that a shape should apply to all subjects in a graph, or to nodes selected by completely different, application-specific mechanisms.
    </p>
    <p>
      This section defines richer mechanisms to define <a href="#dfn-target" class="internalDFN" data-link-type="dfn">targets</a>, called <dfn data-dfn-type="dfn" id="dfn-custom-targets">custom targets</dfn>. Custom targets are the <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of the property <code>sh:target</code> in the <a href="#dfn-shapes-graph" class="internalDFN" data-link-type="dfn">shapes graph</a>. The property <code>sh:target</code> has a similar status as, for example, <code>sh:targetClass</code>, and all <a href="#dfn-subject" class="internalDFN" data-link-type="dfn">subjects</a> of <code>sh:target</code> <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a> are also <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shapes</a>.
    </p>
    <p class="syntax">
      <span data-syntax-rule="target-nodeKind" id="syntax-rule-target-nodeKind">The <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>sh:target</code> at a <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> are
				<a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRIs</a> or <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">blank nodes</a>.</span>
    </p>
    <p>
      A SHACL engine that supports <a href="#dfn-custom-targets" class="internalDFN" data-link-type="dfn">custom targets</a> uses the <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of the <a href="#dfn-custom-targets" class="internalDFN" data-link-type="dfn">custom target</a> node to compute the target nodes for the associated <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a>. The algorithm that is used for this computation depends on the <code>rdf:type</code> of the <a href="#dfn-custom-targets" class="internalDFN" data-link-type="dfn">custom target</a>. The following sub-sections define two such algorithms:
    </p>
    <ul>
      <li><a href="#dfn-sparql-based-targets" class="internalDFN" data-link-type="dfn">SPARQL-based targets</a></li>
      <li><a href="#dfn-sparql-based-target-types" class="internalDFN" data-link-type="dfn">SPARQL-based target types</a></li>
    </ul>
    <p>
      However, other types of targets can be supported by other extension languages such as JavaScript. The class <code>sh:Target</code> is the recommended base class for such extensions.
    </p>
    <p>
      The behavior of a SHACL engine that is unable to handle a given <a href="#dfn-custom-targets" class="internalDFN" data-link-type="dfn">custom target</a> is left undefined. SHACL Core processors do not even need to be aware of the existence of the <code>sh:target</code> property. Engines that are aware of this property and cannot handle a given <a href="#dfn-custom-targets" class="internalDFN" data-link-type="dfn">custom target</a> <em class="rfc2119" title="SHOULD">SHOULD</em> at least report a warning.
    </p>

    <section id="SPARQLTarget" typeof="bibo:Chapter" resource="#SPARQLTarget" property="bibo:hasPart">
      <h3 id="h-sparqltarget" resource="#h-sparqltarget"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.1 </span>SPARQL-based Targets</span>
      </h3>
      <p>
        <a href="#dfn-custom-targets" class="internalDFN" data-link-type="dfn">Custom targets</a> that are <a href="#dfn-shacl-instance" class="internalDFN" data-link-type="dfn">SHACL instances</a> of <code>sh:SPARQLTarget</code> are called
        <dfn data-dfn-type="dfn" id="dfn-sparql-based-targets">SPARQL-based targets</dfn>.
      </p>
      <p class="syntax">
        <span data-syntax-rule="SPARQLTarget-select-count" id="syntax-rule-SPARQLTarget-select-count"><a href="#dfn-sparql-based-targets" class="internalDFN" data-link-type="dfn">SPARQL-based targets</a> have exactly one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for the property <code>sh:select</code>.</span>
        <span data-syntax-rule="SPARQLTarget-prefixes-nodeKind" id="syntax-rule-SPARQLTarget-prefixes-nodeKind"><a href="#dfn-sparql-based-targets" class="internalDFN" data-link-type="dfn">SPARQL-based targets</a> may have <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> for the property <code>sh:prefixes</code>
					and these values are <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRIs</a> or <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">blank nodes</a>.</span>
        <span data-syntax-rule="SPARQLTarget-select-sparql" id="syntax-rule-SPARQLTarget-select-sparql">Using the <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>sh:prefixes</code> as defined by
					<a href="https://www.w3.org/TR/shacl/#sparql-prefixes">5.2.1 Prefix Declarations for SPARQL Queries</a>,
					the <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>sh:select</code> must be valid SPARQL 1.1 SELECT queries with a single result variable <code>this</code>.</span>
        <span data-syntax-rule="SPARQLTarget-ask-count" id="syntax-rule-SPARQLTarget-ask-count"><a href="#dfn-sparql-based-targets" class="internalDFN" data-link-type="dfn">SPARQL-based targets</a> have at most one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for the property <code>sh:ask</code>.</span>
      </p>
      <p>
        The following example declares a well-formed SPARQL-based target that produces all persons born in the USA:
      </p>
      <pre class="example-shapes" title="SPARQL-based target example">ex:
	sh:declare [
		sh:prefix "ex" ;
		sh:namespace &lt;http://example.com/ns#&gt; ;
	] .
				
ex:USCitizenShape
	a sh:NodeShape ;
	sh:target [
		a sh:SPARQLTarget ;
		sh:prefixes ex: ;
		sh:select """
			SELECT ?this
			WHERE {
				?this a ex:Person .
				?this ex:bornIn ex:USA .
			}
			""" ;
	] ;
	...</pre>
      <div class="def def-text">
        <div class="def-header">TEXTUAL DEFINITION</div>
        <div class="def-text-body">
          Let <code>Q</code> be the SPARQL SELECT query derived from the <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>sh:select</code> and <code>sh:prefixes</code> of the <a href="#dfn-sparql-based-targets" class="internalDFN" data-link-type="dfn">SPARQL-based target</a> <code>T</code>. The <a href="#dfn-target" class="internalDFN" data-link-type="dfn">target</a> nodes of <code>T</code> are the <a href="#dfn-binding" class="internalDFN" data-link-type="dfn">bindings</a> of the variable <code>this</code> returned by <code>Q</code> against the <a href="#dfn-data-graph" class="internalDFN" data-link-type="dfn">data graph</a>.
        </div>
      </div>
      <p>
        While the SELECT queries can be used to identify all <a href="#dfn-focus-node" class="internalDFN" data-link-type="dfn">focus nodes</a> for a given <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a>, SHACL processors sometimes also need to compute the inverse direction and find all <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shapes</a> for which a given <a href="#dfn-node" class="internalDFN" data-link-type="dfn">node</a> needs to be validated against. For this reason, the following semantic restriction is recommended for SELECT queries used in SPARQL-based targets. Informally, SHACL Full processors should be able to derive an equivalent ASK query from the SELECT query,
        <a href="#dfn-pre-binding" class="internalDFN" data-link-type="dfn">pre-bind</a> the potential <a href="#dfn-focus-node" class="internalDFN" data-link-type="dfn">focus node</a>, and check whether the potential focus node needs to be validated against the <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> that has the given target. Formally, let <code>A</code> be a SPARQL ASK query that is produced by replacing the <a href="https://www.w3.org/TR/sparql11-query/#rSelectClause">SelectClause</a> with <code>ASK</code> in the outermost SELECT query. Let <code>rs</code> be the set of RDF terms returned as <a href="#dfn-binding" class="internalDFN" data-link-type="dfn">bindings</a> for the variable <code>this</code> in the <a href="#dfn-solution" class="internalDFN" data-link-type="dfn">solutions</a> of the SELECT query. Then <code>A</code> returns <code>true</code> if and only if the variable <code>this</code> is <a href="#dfn-pre-binding" class="internalDFN" data-link-type="dfn">pre-bound</a> with a value from <code>rs</code>. If the SELECT query of a SPARQL-based target does not fulfill this requirement, it needs to be accompanied by a SPARQL ASK query as the value for <code>sh:ask</code>. A SHACL engine can then determine whether a given <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> applies to a given <a href="#dfn-node" class="internalDFN" data-link-type="dfn">node</a> by executing the ASK query with the variable <code>this</code> <a href="#dfn-pre-binding" class="internalDFN" data-link-type="dfn">pre-bound</a> to the <a href="#dfn-node" class="internalDFN" data-link-type="dfn">node</a>. If the ASK query evaluates to <code>true</code> then the <a href="#dfn-node" class="internalDFN" data-link-type="dfn">node</a> is in the target of the <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a>.
      </p>
    </section>

    <section id="SPARQLTargetType" typeof="bibo:Chapter" resource="#SPARQLTargetType" property="bibo:hasPart">
      <h3 id="h-sparqltargettype" resource="#h-sparqltargettype"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.2 </span>SPARQL-based Target Types</span>
      </h3>
      <p>
        In some cases it would be too repetitive to declare SPARQL-based targets with similar SPARQL queries that only differ in a few aspects. SHACL-SPARQL defines a mechanism for user-defined <a href="#dfn-constraint-component" class="internalDFN" data-link-type="dfn">constraint components</a>, allowing users to reuse the same SPARQL query in a parameterized form. The SPARQL-based target types introduced in this section follow a similar design.
      </p>
      <p>
        The class <code>sh:TargetType</code> can be used to declare high-level vocabularies for targets in a <a href="#dfn-shapes-graph" class="internalDFN" data-link-type="dfn">shapes graph</a>. The class <code>sh:SPARQLTargetType</code> is declared as <code>rdfs:subClassOf sh:TargetType</code> for
        <dfn data-dfn-type="dfn" id="dfn-sparql-based-target-types">SPARQL-based target types</dfn>. Other extension languages may define alternative execution instructions for target types with the same IRI, making them potentially more platform independent than pure <a href="#dfn-sparql-based-targets" class="internalDFN" data-link-type="dfn">SPARQL-based targets</a>. Instances of the class <code>sh:SPARQLTargetType</code> specify a SPARQL SELECT query via the property <code>sh:select</code>, and this query has to fulfill the same syntactic and semantic rules as <a href="#SPARQLTarget">SPARQL-based targets</a>.
      </p>
      <p>
        Similar to SPARQL-based <a href="#dfn-constraint-component" class="internalDFN" data-link-type="dfn">constraint components</a>, such targets take <a href="#dfn-parameter" class="internalDFN" data-link-type="dfn">parameters</a> and the parameter values become <a href="#dfn-pre-binding" class="internalDFN" data-link-type="dfn">pre-bound</a> variables in the associated SPARQL queries. The parameter values of such targets cannot not be blank nodes, and the same target cannot have more than one value per parameter. A target that lacks a <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for a non-optional parameter is ignored, producing no target nodes. Similar to SPARQL-based <a href="#dfn-constraint-component" class="internalDFN" data-link-type="dfn">constraint components</a>, target types may also have values for the property <code>sh:labelTemplate</code>.
      </p>
      <p>
        The following example declares a new SPARQL-based target type that takes one parameter <code>ex:country</code> that gets mapped into the variable <code>country</code> in the corresponding SPARQL query to determine the resulting target nodes.
      </p>
      <pre class="example-shapes">ex:PeopleBornInCountryTarget
	a sh:SPARQLTargetType ;
	rdfs:subClassOf sh:Target ;
	sh:labelTemplate "All persons born in {$country}" ;
	sh:parameter [
		sh:path ex:country ;
		sh:description "The country that the focus nodes are 'born' in." ;
		sh:class ex:Country ;
		sh:nodeKind sh:IRI ;
	] ;
	sh:prefixes ex: ;
	sh:select """
		SELECT ?this
		WHERE {
			?this a ex:Person .
			?this ex:bornIn $country .
		}
		""" .</pre>
      <p>
        Once such a target type has been defined in a <a href="#dfn-shapes-graph" class="internalDFN" data-link-type="dfn">shapes graph</a>, it can be used by multiple shapes:
      </p>
      <pre class="example-shapes">ex:GermanCitizenShape
	a sh:NodeShape ;
	sh:target [
		a ex:BornInCountryTarget ;
		ex:country ex:Germany ;
	] ;
	...
	
ex:USCitizenShape
	a sh:NodeShape ;
	sh:target [
		a ex:BornInCountryTarget ;
		ex:country ex:USA ;
	] ;
	...</pre>
      <p>
        The set of focus nodes produced by such a target type consists of all bindings of the variable <code>this</code> in the result set, when the SPARQL SELECT query has been executed with the <a href="#dfn-pre-binding" class="internalDFN" data-link-type="dfn">pre-bound</a> parameter values.
      </p>
    </section>
  </section>

  <section id="sparql-constraints-annotations" typeof="bibo:Chapter" resource="#sparql-constraints-annotations" property="bibo:hasPart">
    <!--OddPage-->
    <h2 id="h-sparql-constraints-annotations" resource="#h-sparql-constraints-annotations"><span property="xhv:role" resource="xhv:heading"><span class="secno">4. </span>Annotation Properties</span>
    </h2>
    <p>
      This section extends the general <a href="https://www.w3.org/TR/shacl/#sparql-constraints-variables">mechanism from SHACL-SPARQL</a> [
      <cite><a class="bibref" href="#bib-shacl">shacl</a></cite>] to produce <a href="#dfn-validation-report" class="internalDFN" data-link-type="dfn">validation reports</a> as a result of the <a href="#dfn-validation" class="internalDFN" data-link-type="dfn">validation</a>.
    </p>
    <p>
      Implementations that support this feature make it possible to inject so-called <dfn data-dfn-type="dfn" id="dfn-annotation-properties">annotation properties</dfn> into the validation result nodes created for each <a href="#dfn-solution" class="internalDFN" data-link-type="dfn">solution</a> produced by the SELECT queries of a SPARQL-based <a href="#dfn-constraint" class="internalDFN" data-link-type="dfn">constraint</a> or <a href="#dfn-constraint-component" class="internalDFN" data-link-type="dfn">constraint component</a>. Any such annotation property needs to be declared via a <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> of <code>sh:resultAnnotation</code> at the <a href="#dfn-subject" class="internalDFN" data-link-type="dfn">subject</a> of the <code>sh:select</code> or <code>sh:ask</code> <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triple</a>.
    </p>
    <p class="syntax">
      <span data-syntax-rule="resultAnnotation-nodeKind" id="syntax-rule-resultAnnotation-nodeKind">The <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>sh:resultAnnotation</code> are
				called <dfn data-dfn-type="dfn" id="dfn-result-annotations">result annotations</dfn> and are either <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRIs</a> or <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">blank nodes</a></span>.
    </p>
    <p>
      <a href="#dfn-result-annotations" class="internalDFN" data-link-type="dfn">Result annotations</a> have the following properties:
    </p>
    <table class="term-table">
      <tbody>
        <tr>
          <th>Property</th>
          <th>Summary and Syntax Rules</th>
        </tr>
        <tr>
          <td><code>sh:annotationProperty</code></td>
          <td>
            The property that shall be set.
            <span data-syntax-rule="annotationProperty" id="syntax-rule-annotationProperty">Each <a href="#dfn-result-annotations" class="internalDFN" data-link-type="dfn">result annotation</a> has exactly one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a>
						for the property <code>sh:annotationProperty</code> and this value is an <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRI</a>.</span>
          </td>
        </tr>
        <tr>
          <td><code>sh:annotationVarName</code></td>
          <td>
            The name of the SPARQL variable to take the annotation values from.
            <span data-syntax-rule="annotationVarName" id="syntax-rule-annotationVarName">Each <a href="#dfn-result-annotations" class="internalDFN" data-link-type="dfn">result annotation</a> has at most 1 <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a>
						for the property <code>sh:annotationVarName</code> and this <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> is <a href="#dfn-literal" class="internalDFN" data-link-type="dfn">literal</a> with
						<a href="#dfn-datatype" class="internalDFN" data-link-type="dfn">datatype</a> <code>xsd:string</code>.</span>
          </td>
        </tr>
        <tr>
          <td><code>sh:annotationValue</code></td>
          <td>
            Constant <a href="#dfn-rdf-term" class="internalDFN" data-link-type="dfn">RDF terms</a> that shall be used as default values.
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      For each <a href="#dfn-solution" class="internalDFN" data-link-type="dfn">solution</a> of a SELECT result set, a SHACL processor that supports annotations walks through the declared result annotations. The mapping from result annotations to SPARQL variables uses the following rules:
    </p>
    <ol>
      <li>Use the <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> of the property <code>sh:annotationVarName</code></li>
      <li>If no such <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> exists, use the <a href="#dfn-local-name" class="internalDFN" data-link-type="dfn">local name</a> of the <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> of <code>sh:annotationProperty</code> as the variable name</li>
    </ol>
    <p>
      If a variable name could be determined, then the SHACL processor copies the <a href="#dfn-binding" class="internalDFN" data-link-type="dfn">binding</a> for the given variable as a value for the property specified using <code>sh:annotationProperty</code> into the validation result that is being produced for the current <a href="#dfn-solution" class="internalDFN" data-link-type="dfn">solution</a>. If the variable has no <a href="#dfn-binding" class="internalDFN" data-link-type="dfn">binding</a> in the result set <a href="#dfn-solution" class="internalDFN" data-link-type="dfn">solution</a>, then the <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>sh:annotationValue</code> is used, if present.
    </p>
    <p>
      Here is an example illustrating the use of result annotations.
    </p>
    <pre class="example-shapes">ex:AnnotationExample
	a sh:NodeShape ;
	sh:targetNode ex:ExampleResource ;
	sh:sparql [   # _:b1
		sh:resultAnnotation [
			sh:annotationProperty ex:time ;
			sh:annotationVarName "time" ;
		] ;
		sh:select """
			SELECT $this ?message ?time
			WHERE {
				BIND (CONCAT("The ", "message.") AS ?message) .
				BIND (NOW() AS ?time) .
			}
			""" ;
	] .</pre>
    <p>
      Validation produces the following validation report:
    </p>
    <pre class="example-results">[	a sh:ValidationReport ;
	sh:conforms false ;
	sh:result [
		a sh:ValidationResult ;
		sh:focusNode ex:ExampleResource ;
		sh:resultMessage "The message." ;
		sh:resultSeverity sh:Violation ;
		sh:sourceConstraint _:b1 ;
		sh:sourceConstraintComponent sh:SPARQLConstraintComponent ;
		sh:sourceShape ex:AnnotationExample ;
		ex:time "2015-03-27T10:58:00"^^xsd:dateTime ;  # Example
	]
] .</pre>
  </section>

  <section id="functions" typeof="bibo:Chapter" resource="#functions" property="bibo:hasPart">
    <!--OddPage-->
    <h2 id="h-functions" resource="#h-functions"><span property="xhv:role" resource="xhv:heading"><span class="secno">5. </span>SHACL Functions</span>
    </h2>
    <p>
      <dfn data-dfn-type="dfn" id="dfn-shacl-functions">SHACL functions</dfn> declare operations that produce an <a href="#dfn-rdf-term" class="internalDFN" data-link-type="dfn">RDF term</a> based on zero or more <a href="#dfn-parameter" class="internalDFN" data-link-type="dfn">parameters</a> and a <a href="#dfn-data-graph" class="internalDFN" data-link-type="dfn">data graph</a>. Each SHACL function has an <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRI</a>. The actual execution logic (or algorithm) of a SHACL function can be declared in a variety of execution languages. This document defines one specific kind of SHACL functions, the <a href="#dfn-sparql-based-functions" class="internalDFN" data-link-type="dfn">SPARQL-based functions</a>. JavaScript-based Functions are defined in the separate SHACL-JS document [<cite><a class="bibref" href="#bib-shacl-js">shacl-js</a></cite>]. The same function <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRI</a> can potentially be executed on a multitude of platforms, if it declares execution instructions for these platforms.
    </p>
    <p>
      SHACL functions can be called within FILTER or BIND clauses and similar features of SPARQL queries. SHACL functions can also be used declaratively in frameworks such as the SHACL <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expressions</a> which are used in <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">SHACL rules</a>. In those scenarios they may be used to perform data transformations such as string concatenation.
    </p>

    <section id="functions-example" typeof="bibo:Chapter" resource="#functions-example" property="bibo:hasPart">
      <h3 id="h-functions-example" resource="#h-functions-example"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.1 </span>An Example SHACL Function</span>
      </h3>
      <p>
        The following example illustrates the declaration of a SHACL function based on a simple mathematical SPARQL query.
      </p>
      <pre class="example-shapes" title="SHACL function with a SPARQL body">ex:multiply
	a sh:SPARQLFunction ;
	rdfs:comment "Multiplies its two arguments $op1 and $op2." ;
	sh:parameter [
		sh:path ex:op1 ;
		sh:datatype xsd:integer ;
		sh:description "The first operand" ;
	] ;
	sh:parameter [
		sh:path ex:op2 ;
		sh:datatype xsd:integer ;
		sh:description "The second operand" ;
	] ;
	sh:returnType xsd:integer ;
	sh:select """
		SELECT ($op1 * $op2 AS ?result)
		WHERE {
		}
		""" .</pre>
      <p>
        Using the declaration above, SPARQL engines that support SHACL functions install a new SPARQL function based on the SPARQL 1.1 <a href="https://www.w3.org/TR/sparql11-query/#extensionFunctions">Extensible Value Testing</a> mechanism. Such engines are then able to handle expressions such as <code>ex:multiply(7, 8)</code>, producing <code>56</code>, as illustrated in the following SPARQL query.
      </p>
      <pre class="example-other" title="Call of a SHACL function in a SPARQL query">SELECT ?subject ?area
WHERE {
	?subject ex:width ?width .
	?subject ex:height ?height .
	BIND (ex:multiply(?width, ?height) AS ?area) .
}</pre>
      <p>
        The following sections introduce the general properties that such functions may have, before the specific characteristics of <a href="#dfn-sparql-based-functions" class="internalDFN" data-link-type="dfn">SPARQL-based functions</a> are defined.
      </p>
    </section>

    <section id="function-parameters" typeof="bibo:Chapter" resource="#function-parameters" property="bibo:hasPart">
      <h3 id="h-function-parameters" resource="#h-function-parameters"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.2 </span>Function Parameters</span>
      </h3>
      <p>
        The parameters of a <a href="#dfn-shacl-functions" class="internalDFN" data-link-type="dfn">SHACL function</a> are declared using the property <code>sh:parameter</code>. This corresponds closely to the <a href="https://www.w3.org/TR/shacl/#constraint-components-parameters">parameter
					declarations of SPARQL-based constraint components</a>, and the same syntax rules apply.
      </p>
      <p id="parameters-ordering">
        Parameters are ordered, corresponding to the notation of function calls in SPARQL such as
        <code>ex:exampleFunction(?param1, ?param2)</code>. The ordering of function parameters is determined as follows:
      </p>
      <ul>
        <li>
          If any of the parameters have a <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for <code>sh:order</code> then all of them are ordered in ascending order by the parameters' numeric <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>sh:order</code>, using <code>0</code> as default value if unspecified.
        </li>
        <li>
          If none of the parameters have a <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for <code>sh:order</code> then all of them are ordered in ascending order of the <a href="#dfn-local-name" class="internalDFN" data-link-type="dfn">local names</a> of their declared <code>sh:path</code> values.
        </li>
      </ul>
      <p>
        Each parameter may have its property <code>sh:optional</code> set to <code>true</code> to indicate that the parameter is not mandatory. If a function gets invoked without all its mandatory parameters then it returns no result node (an error in SPARQL, producing unbound in a BIND statement).
      </p>
    </section>

    <section id="function-returnType" typeof="bibo:Chapter" resource="#function-returnType" property="bibo:hasPart">
      <h3 id="h-function-returntype" resource="#h-function-returntype"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.3 </span>sh:returnType</span>
      </h3>
      <p>
        A function may declare a single <dfn data-dfn-type="dfn" id="dfn-return-type">return type</dfn> via <code>sh:returnType</code>.
      </p>
      <p class="syntax">
        <span data-syntax-rule="returnType-maxCount" id="syntax-rule-returnType-maxCount">A function has at most one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for <code>sh:returnType</code>.</span>
        <span data-syntax-rule="returnType-nodeKind" id="syntax-rule-returnType-nodeKind">The values of <code>sh:returnType</code> are <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRIs</a>.</span>
      </p>
      <p>
        The <a href="#dfn-return-type" class="internalDFN" data-link-type="dfn">return type</a> may serve for documentation purposes only. However, in some execution languages such as JavaScript, the declared <code>sh:returnType</code> may inform a processor how to cast a native value into an <a href="#dfn-rdf-term" class="internalDFN" data-link-type="dfn">RDF term</a>.
      </p>
    </section>

    <section id="SPARQLFunction" typeof="bibo:Chapter" resource="#SPARQLFunction" property="bibo:hasPart">
      <h3 id="h-sparqlfunction" resource="#h-sparqlfunction"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.4 </span>SPARQL-based Functions</span>
      </h3>
      <p>
        <a href="#dfn-shacl-instance" class="internalDFN" data-link-type="dfn">SHACL instances</a> of <code>sh:SPARQLFunction</code> that are <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRIs</a> in a <a href="#dfn-shapes-graph" class="internalDFN" data-link-type="dfn">shapes graph</a> are called <dfn data-dfn-type="dfn" id="dfn-sparql-based-functions">SPARQL-based functions</dfn>.
      </p>
      <p class="syntax">
        <span data-syntax-rule="SPARQLFunction-query" id="syntax-rule-SPARQLFunction-query"><a href="#dfn-sparql-based-functions" class="internalDFN" data-link-type="dfn">SPARQL-based functions</a> have exactly one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for either <code>sh:ask</code> or <code>sh:select</code>.
					The <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of these properties are strings that can be parsed into SPARQL queries of type ASK (for <code>sh:ask</code>)
					or SELECT (for <code>sh:select</code>) using the SHACL-SPARQL <a href="https://www.w3.org/TR/shacl/#sparql-prefixes">prefix declaration mechanism</a>.
					SELECT queries return exactly one result variable and do not use the <code>SELECT *</code> syntax.</span>
      </p>
      <p>
        When the function is executed, the SPARQL processor needs to <a href="#dfn-pre-binding" class="internalDFN" data-link-type="dfn">pre-bind</a> variables based on the provided arguments of the function call. In the <a href="#functions-example">SHACL functions example</a> above, the value for the parameter declared as
        <code>ex:op1</code> is <a href="#dfn-pre-binding" class="internalDFN" data-link-type="dfn">pre-bound</a> to the SPARQL variable <code>$op1</code>, etc. For ASK queries, the function's return value is the result of the ASK query execution, i.e. <code>true</code> or <code>false</code>. For SELECT queries, the function's return value is the <a href="#dfn-binding" class="internalDFN" data-link-type="dfn">binding</a> of the (single) result variable of the first <a href="#dfn-solution" class="internalDFN" data-link-type="dfn">solution</a> in the result set. Since all other bindings will be ignored, such SELECT queries should only return at most one <a href="#dfn-solution" class="internalDFN" data-link-type="dfn">solution</a>. If the result variable is unbound, then the function generates a <a href="https://www.w3.org/TR/sparql11-query/#invocation">SPARQL error</a>.
      </p>
    </section>
  </section>

  <section id="node-expressions" typeof="bibo:Chapter" resource="#node-expressions" property="bibo:hasPart">
    <!--OddPage-->
    <h2 id="h-node-expressions" resource="#h-node-expressions"><span property="xhv:role" resource="xhv:heading"><span class="secno">6. </span>Node Expressions</span>
    </h2>
    <p>
      This section defines a feature called <dfn data-dfn-type="dfn" id="dfn-node-expressions">node expressions</dfn>. Node expressions are declared as RDF nodes in a <a href="#dfn-shapes-graph" class="internalDFN" data-link-type="dfn">shapes graph</a> and instruct a SHACL engine how to compute a set of <a href="#dfn-node" class="internalDFN" data-link-type="dfn">nodes</a> for a given <a href="#dfn-focus-node" class="internalDFN" data-link-type="dfn">focus node</a>. Each <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a> has one of the following types, each of which is defined together with its evaluation semantics in the following sub-sections.
    </p>
    <table class="term-table">
      <tbody>
        <tr>
          <th>Node&nbsp;Expression&nbsp;Type</th>
          <th>Syntax (Informative)</th>
          <th>Summary</th>
        </tr>
        <tr>
          <td><a href="#dfn-focus-node-expression" class="internalDFN" data-link-type="dfn">Focus Node Expression</a></td>
          <td><code>sh:this</code></td>
          <td>The set consisting of the current <a href="#dfn-focus-node" class="internalDFN" data-link-type="dfn">focus node</a>.</td>
        </tr>
        <tr>
          <td><a href="#dfn-constant-term-expression" class="internalDFN" data-link-type="dfn">Constant&nbsp;Term&nbsp;Expression</a></td>
          <td>Any <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRI</a> or <a href="#dfn-literal" class="internalDFN" data-link-type="dfn">literal</a> except <code>sh:this</code></td>
          <td>The set consisting of the given <a href="#dfn-rdf-term" class="internalDFN" data-link-type="dfn">term</a>.</td>
        </tr>
        <tr>
          <td><a href="#dfn-function-expression" class="internalDFN" data-link-type="dfn">Function Expression</a></td>
          <td><a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">Blank node</a> with a list-valued triple</td>
          <td>The results of evaluating a given <a href="#dfn-shacl-functions" class="internalDFN" data-link-type="dfn">SHACL Function</a>.</td>
        </tr>
        <tr>
          <td><a href="#dfn-path-expression" class="internalDFN" data-link-type="dfn">Path Expression</a></td>
          <td><a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">Blank node</a> with <code>sh:path</code></td>
          <td>The <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of a given <a href="#dfn-property-path" class="internalDFN" data-link-type="dfn">property path</a>.</td>
        </tr>
        <tr>
          <td><a href="#dfn-filter-shape-expression" class="internalDFN" data-link-type="dfn">Filter Shape Expression</a></td>
          <td><a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">Blank node</a> with <code>sh:filterShape</code> and <code>sh:nodes</code></td>
          <td>The sub-set of the input nodes that conform to a given <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a>.</td>
        </tr>
        <tr>
          <td><a href="#dfn-intersection-expression" class="internalDFN" data-link-type="dfn">Intersection Expression</a></td>
          <td><a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">Blank node</a> with <code>sh:intersection</code></td>
          <td>The intersection of two or more input sets.</td>
        </tr>
        <tr>
          <td><a href="#dfn-union-expression" class="internalDFN" data-link-type="dfn">Union Expression</a></td>
          <td><a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">Blank node</a> with <code>sh:union</code></td>
          <td>The union set of two or more input sets.</td>
        </tr>
      </tbody>
    </table>
    <p>
      The basic idea of these expressions is that they can be used to derive a set of RDF nodes from a given <a href="#dfn-focus-node" class="internalDFN" data-link-type="dfn">focus node</a>, for example the set of all values of a given property of the focus node. Some of these expressions can be nested, i.e. they use the output of another expression as their input, leading to evaluation chains and trees.
    </p>
    <p>
      The following example declares a <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a> that produces the display labels of all values of the property <code>ex:customer</code> that <a href="#dfn-conformance" class="internalDFN" data-link-type="dfn">conform</a> to a given <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> <code>ex:GoodCustomerShape</code>. The assumption here is that there is a <a href="#dfn-shacl-functions" class="internalDFN" data-link-type="dfn">SHACL function</a> <code>ex:displayLabel</code> which declares a single parameter.
    </p>
    <pre class="example-shapes" title="Node expression example">[
	ex:displayLabel ( [
		sh:filterShape ex:GoodCustomerShape ;
		sh:nodes [ sh:path ex:customer ] ;
	] )
] .</pre>
    <p>
      To evaluate this example, an engine gets all <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>ex:customer</code> of the <a href="#dfn-focus-node" class="internalDFN" data-link-type="dfn">focus node</a>, then filters them according to the <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> <code>ex:GoodCustomerShape</code> and repeatedly calls the <a href="#dfn-shacl-functions" class="internalDFN" data-link-type="dfn">SHACL function</a> <code>ex:displayLabel</code> with all values that pass the filter shape as arguments.
    </p>
    <p>
      Important use cases of such expressions are <a href="#dfn-expression-constraints" class="internalDFN" data-link-type="dfn">expression constraints</a> and <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">SHACL rules</a>, yet the basic functionality and vocabulary may find many other application areas.
    </p>
    <p>
      Each of the following sub-sections defines a node expression type with its syntax rules and evaluation semantics based on a mapping operation <code>Eval($expr, $this)</code> where the first argument <code>$expr</code> is the given expression, <code>$this</code> is the current <a href="#dfn-focus-node" class="internalDFN" data-link-type="dfn">focus node</a> and which produces a set of RDF nodes.
    </p>
    <p class="syntax">
      <span data-syntax-rule="node-expressions-recursion" id="syntax-rule-node-expressions-recursion">A <code>node expression</code> cannot recursively have itself
				as a "nested" node expression, e.g. as <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> of <code>sh:nodes</code>.</span>
    </p>

    <section id="node-expressions-focus" typeof="bibo:Chapter" resource="#node-expressions-focus" property="bibo:hasPart">
      <h3 id="h-node-expressions-focus" resource="#h-node-expressions-focus"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.1 </span>Focus Node Expressions</span>
      </h3>
      <p>
        The <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRI</a> <code>sh:this</code> is the (only) node declaring a <dfn data-dfn-type="dfn" id="dfn-focus-node-expression">focus node expression</dfn>.
      </p>
      <div class="def def-text">
        <div class="def-header">EVALUATION OF FOCUS NODE EXPRESSIONS</div>
        <div class="def-text-body">
          For the <a href="#dfn-focus-node-expression" class="internalDFN" data-link-type="dfn">focus node expression</a> <code>sh:this</code>, <code>Eval(sh:this, $this)</code> produces the set <code>{ $this }</code>.
        </div>
      </div>
    </section>

    <section id="node-expressions-constant" typeof="bibo:Chapter" resource="#node-expressions-constant" property="bibo:hasPart">
      <h3 id="h-node-expressions-constant" resource="#h-node-expressions-constant"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.2 </span>Constant Term Expressions</span>
      </h3>
      <p>
        Any <a href="#dfn-literal" class="internalDFN" data-link-type="dfn">literal</a> or <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRI</a> except <code>sh:this</code> declares a <dfn data-dfn-type="dfn" id="dfn-constant-term-expression">constant term expression</dfn>.
      </p>
      <div class="def def-text">
        <div class="def-header">EVALUATION OF CONSTANT TERM EXPRESSIONS</div>
        <div class="def-text-body">
          For the <a href="#dfn-constant-term-expression" class="internalDFN" data-link-type="dfn">constant term expression</a> <code>$expr</code>, <code>Eval($expr, $this)</code> produces the set <code>{ $expr }</code>.
        </div>
      </div>
    </section>

    <section id="node-expressions-filter-shape" typeof="bibo:Chapter" resource="#node-expressions-filter-shape" property="bibo:hasPart">
      <h3 id="h-node-expressions-filter-shape" resource="#h-node-expressions-filter-shape"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.3 </span>Filter Shape Expressions</span>
      </h3>
      <p class="syntax">
        <span data-syntax-rule="FilterShapeExpression" id="syntax-rule-FilterShapeExpression">A <dfn data-dfn-type="dfn" id="dfn-filter-shape-expression">filter shape expression</dfn> is a <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">blank node</a>
					with exactly one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for <code>sh:filterShape</code> (which is a well-formed <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a>)
					and exactly one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for <code>sh:nodes</code> (which is a well-formed <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a>).</span>
      </p>
      <div class="def def-text">
        <div class="def-header">EVALUATION OF FILTER SHAPE EXPRESSIONS</div>
        <div class="def-text-body">
          For the <a href="#dfn-filter-shape-expression" class="internalDFN" data-link-type="dfn">filter shape expression</a> <code>$expr</code> with <code>S</code> being the <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> that is the <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> of <code>sh:filterShape</code> and <code>N</code> being the <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a> that is the <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> of <code>sh:nodes</code>, <code>Eval($expr, $this)</code> produces the set of nodes for each <a href="#dfn-node" class="internalDFN" data-link-type="dfn">node</a> <code>n</code> produced by evaluating <code>N</code> where <code>n</code> <a href="#dfn-conformance" class="internalDFN" data-link-type="dfn">conforms</a> to <code>S</code>.
        </div>
      </div>
    </section>

    <section id="node-expressions-function" typeof="bibo:Chapter" resource="#node-expressions-function" property="bibo:hasPart">
      <h3 id="h-node-expressions-function" resource="#h-node-expressions-function"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.4 </span>Function Expressions</span>
      </h3>
      <p class="syntax">
        <span data-syntax-rule="FunctionExpression" id="syntax-rule-FunctionExpression">A <dfn data-dfn-type="dfn" id="dfn-function-expression">function expression</dfn> is a <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">blank node</a>
					that does not fulfill any of the syntax rules of the other node expression types and which
					is the <a href="#dfn-subject" class="internalDFN" data-link-type="dfn">subject</a> of exactly one <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triple</a> <code>T</code> where the <a href="#dfn-object" class="internalDFN" data-link-type="dfn">object</a> is a well-formed <a href="#dfn-shacl-list" class="internalDFN" data-link-type="dfn">SHACL list</a>,
					and each <a href="#dfn-member" class="internalDFN" data-link-type="dfn">member</a> of that list is a well-formed <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a>.</span>
      </p>
      <div class="def def-text">
        <div class="def-header">EVALUATION OF FUNCTION EXPRESSIONS</div>
        <div class="def-text-body">
          For the <a href="#dfn-function-expression" class="internalDFN" data-link-type="dfn">function expression</a> <code>$expr</code>, <code>Eval($expr, $this)</code> produces the set of <a href="#dfn-node" class="internalDFN" data-link-type="dfn">nodes</a> returned by evaluating the <a href="#dfn-shacl-functions" class="internalDFN" data-link-type="dfn">SHACL function</a> specified as <a href="#dfn-predicate" class="internalDFN" data-link-type="dfn">predicate</a> of the triple <code>T</code> mentioned above. The arguments of the function call(s) are based on the results of the <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expressions</a> listed in the <a href="#dfn-object" class="internalDFN" data-link-type="dfn">object</a> list of <code>T</code> so that the first list <a href="#dfn-member" class="internalDFN" data-link-type="dfn">member</a> is used for the first argument, etc. This is done for all combinations of <a href="#dfn-node" class="internalDFN" data-link-type="dfn">nodes</a> produced by the <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a>. If one of the <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expressions</a> produces the empty set and the corresponding function <a href="#dfn-parameter" class="internalDFN" data-link-type="dfn">parameter</a> is non-optional, then the result is the empty set.
        </div>
      </div>
      <p>
        As illustrated in the following example, <a href="#dfn-function-expression" class="internalDFN" data-link-type="dfn">function expressions</a> are comparable to SPARQL BIND clauses.
      </p>
      <table style="width:100%; border-collapse: collapse;">
        <tbody>
          <tr>
            <td style="width: 50%; padding: 0 4px 0 0">
              <pre class="example-shapes" style="margin-top: 0">[  ex:concat ( 
		[ sh:path ex:firstName ]
		[ sh:path ex:lastName ] 
	)
] .</pre>
            </td>
            <td style="width: 50%; padding: 0 0 0 4px">
              <pre class="example-sparql" style="margin-top: 0">{
	$this ex:firstName ?a .
	$this ex:lastName ?b .
	BIND (ex:concat(?a, ?b) AS ?result) .
}
</pre>
            </td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="node-expressions-path" typeof="bibo:Chapter" resource="#node-expressions-path" property="bibo:hasPart">
      <h3 id="h-node-expressions-path" resource="#h-node-expressions-path"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.5 </span>Path Expressions</span>
      </h3>
      <p class="syntax">
        <span data-syntax-rule="PathExpression" id="syntax-rule-PathExpression">A <dfn data-dfn-type="dfn" id="dfn-path-expression">path expression</dfn> is a <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">blank node</a>
					with exactly one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> of the property <code>sh:path</code> (which are well-formed <a href="#dfn-property-path" class="internalDFN" data-link-type="dfn">property paths</a>)
					and at most one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for <code>sh:nodes</code> (which is a well-formed <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a>).</span>
      </p>
      <div class="def def-text">
        <div class="def-header">EVALUATION OF PATH EXPRESSIONS</div>
        <div class="def-text-body">
          For the <a href="#dfn-path-expression" class="internalDFN" data-link-type="dfn">path expression</a> <code>$expr</code> that has the property path <code>P</code> as its
          <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for <code>sh:path</code> and the <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a> <code>N</code> as its <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for <code>sh:nodes</code> (defaulting to the <a href="#dfn-focus-node-expression" class="internalDFN" data-link-type="dfn">focus node expression</a> if absent),
          <code>Eval($expr, $this)</code> produces the set of <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of all nodes produced by <code>N</code> for the <a href="#dfn-property-path" class="internalDFN" data-link-type="dfn">property path</a> <code>P</code>.
        </div>
      </div>
      <p>
        As illustrated in the following examples, <a href="#dfn-path-expression" class="internalDFN" data-link-type="dfn">path expressions</a> are comparable to SPARQL basic graph patterns.
      </p>
      <table style="width:100%; border-collapse: collapse;">
        <tbody>
          <tr>
            <td style="width: 50%; padding: 0 4px 0 0">
              <pre class="example-shapes" style="margin-top: 0">[  sh:path ex:firstName ] .

[  sh:nodes ex:children ;
   sh:path rdfs:label ;
] .</pre>
            </td>
            <td style="width: 50%; padding: 0 0 0 4px">
              <pre class="example-sparql" style="margin-top: 0">{   $this ex:firstName ?result . }

{   $this ex:children ?a .
    ?a rdfs:label ?result .
}
</pre>
            </td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="intersection" typeof="bibo:Chapter" resource="#intersection" property="bibo:hasPart">
      <h3 id="h-intersection" resource="#h-intersection"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.6 </span>Intersection Expressions</span>
      </h3>
      <p class="syntax">
        <span data-syntax-rule="intersection" id="syntax-rule-intersection">An <dfn data-dfn-type="dfn" id="dfn-intersection-expression">intersection expression</dfn> is a <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">blank node</a>
					with exactly one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for the property <code>sh:intersection</code> which is a well-formed <a href="#dfn-shacl-list" class="internalDFN" data-link-type="dfn">SHACL list</a>
					with at least two <a href="#dfn-member" class="internalDFN" data-link-type="dfn">members</a> (which are well-formed node expressions).</span>
      </p>
      <div class="def def-text">
        <div class="def-header">EVALUATION OF INTERSECTION EXPRESSIONS</div>
        <div class="def-text-body">
          For the <a href="#dfn-intersection-expression" class="internalDFN" data-link-type="dfn">intersection expression</a> <code>$expr</code> that has the list <code>L</code> as its
          <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for <code>sh:intersection</code>, <code>Eval($expr, $this)</code> produces the set of <a href="#dfn-node" class="internalDFN" data-link-type="dfn">nodes</a> that are in all of the result sets produced by the <a href="#dfn-member" class="internalDFN" data-link-type="dfn">members</a> of <code>L</code>.
        </div>
      </div>
    </section>

    <section id="union" typeof="bibo:Chapter" resource="#union" property="bibo:hasPart">
      <h3 id="h-union" resource="#h-union"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.7 </span>Union Expressions</span>
      </h3>
      <p class="syntax">
        <span data-syntax-rule="union" id="syntax-rule-union">A <dfn data-dfn-type="dfn" id="dfn-union-expression">union expression</dfn> is a <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">blank node</a>
					with exactly one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for the property <code>sh:union</code> which is a well-formed <a href="#dfn-shacl-list" class="internalDFN" data-link-type="dfn">SHACL list</a>
					with at least two <a href="#dfn-member" class="internalDFN" data-link-type="dfn">members</a> (which are well-formed node expressions).</span>
      </p>
      <div class="def def-text">
        <div class="def-header">EVALUATION OF UNION EXPRESSIONS</div>
        <div class="def-text-body">
          For the <a href="#dfn-union-expression" class="internalDFN" data-link-type="dfn">union expression</a> <code>$expr</code> that has the list <code>L</code> as its
          <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for <code>sh:union</code>, <code>Eval($expr, $this)</code> produces the set of <a href="#dfn-node" class="internalDFN" data-link-type="dfn">nodes</a> that are in any of the result sets produced by all of the <a href="#dfn-member" class="internalDFN" data-link-type="dfn">members</a> of <code>L</code>.
        </div>
      </div>
      <p>
        As illustrated in the following example, <a href="#dfn-union-expression" class="internalDFN" data-link-type="dfn">union expressions</a> are comparable to SPARQL UNION clauses.
      </p>
      <table style="width:100%; border-collapse: collapse;">
        <tbody>
          <tr>
            <td style="width: 50%; padding: 0 4px 0 0">
              <pre class="example-shapes" style="margin-top: 0">[  sh:union (
		[ sh:path ex:firstName ]
		[ sh:path ex:givenName ]
   )
] .</pre>
            </td>
            <td style="width: 50%; padding: 0 0 0 4px">
              <pre class="example-sparql" style="margin-top: 0">{
	$this ex:firstName ?result . 
} UNION {
	$this ex:givenName ?result . 
}</pre>
            </td>
          </tr>
        </tbody>
      </table>
    </section>
  </section>

  <section id="ExpressionConstraintComponent" typeof="bibo:Chapter" resource="#ExpressionConstraintComponent" property="bibo:hasPart">
    <!--OddPage-->
    <h2 id="h-expressionconstraintcomponent" resource="#h-expressionconstraintcomponent"><span property="xhv:role" resource="xhv:heading"><span class="secno">7. </span>Expression Constraints</span>
    </h2>
    <p>
      Based on <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expressions</a>, this section introduces a <a href="#dfn-constraint-component" class="internalDFN" data-link-type="dfn">constraint component</a> called
      <dfn data-dfn-type="dfn" id="dfn-expression-constraints">expression constraints</dfn>. Expression constraints can be used in any <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> to declare the condition that the
      <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a> specified via <code>sh:expression</code> has <code>true</code> as its (only) result. In the evaluation of these node expressions is repeated for all <a href="#dfn-value-node" class="internalDFN" data-link-type="dfn">value nodes</a> of the <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> as the <a href="#dfn-focus-node" class="internalDFN" data-link-type="dfn">focus node</a>.
    </p>
    <p>
      <span class="component-class">Constraint Component IRI</span>: <code>sh:ExpressionConstraintComponent</code>
    </p>

    <div class="parameters">Parameters:</div>
    <table class="term-table">
      <tbody>
        <tr>
          <th>Property</th>
          <th>Summary and Syntax Rules</th>
        </tr>
        <tr>
          <td><code>sh:expression</code></td>
          <td>
            The <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a> that must return <code>true</code>.
            <span data-syntax-rule="expression-scope" id="syntax-rule-expression-scope">The <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>sh:expression</code> at a
						<a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> must be well-formed <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expressions</a>.</span>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="def def-text">
      <div class="def-header">TEXTUAL DEFINITION</div>
      <div class="def-text-body" data-validator="Filter">
        For each <a href="#dfn-value-node" class="internalDFN" data-link-type="dfn">value node</a> <code>v</code> where <code>Eval(v, $expression)</code> returns a node set that is not equal to <code>{ true }</code> there is a <a href="#dfn-validation-result" class="internalDFN" data-link-type="dfn">validation result</a> that has <code>v</code> as its <code>sh:value</code> and <code>$expression</code> as its <code>sh:sourceConstraint</code>. If the <code>$expression</code> has <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> for <code>sh:message</code> in the <a href="#dfn-shapes-graph" class="internalDFN" data-link-type="dfn">shapes graph</a> then these <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> become the (only) values for <code>sh:resultMessage</code> in the
        <a href="#dfn-validation-result" class="internalDFN" data-link-type="dfn">validation result</a>.
      </div>
    </div>
    <p><em>The remainder of this section is informative.</em></p>
    <p>
      The following example assumes that there are <a href="#dfn-shacl-functions" class="internalDFN" data-link-type="dfn">SHACL functions</a> <code>ex:concat</code>,
      <code>ex:strlen</code> and <code>ex:lessThan</code> and uses them to verify that the combined string length of <code>ex:firstName</code> and <code>ex:lastName</code> is less than 30.
    </p>
    <pre class="example-shapes">ex:FilterExampleShape
	a sh:NodeShape ;
	sh:expression [
		ex:lessThan ( 
			[ ex:strlen ( 
				[ ex:concat ( [ sh:path ex:firstName] [ sh:path ex:lastName ] ) ] ) 
			]
			30 );
	] .</pre>
  </section>

  <section id="rules" typeof="bibo:Chapter" resource="#rules" property="bibo:hasPart">
    <!--OddPage-->
    <h2 id="h-rules" resource="#h-rules"><span property="xhv:role" resource="xhv:heading"><span class="secno">8. </span>SHACL Rules</span>
    </h2>
    <p>
      SHACL defines an RDF vocabulary to describe <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shapes</a> - collections of <a href="#dfn-constraint" class="internalDFN" data-link-type="dfn">constraints</a> that apply to a set of nodes. Shapes can be associated with nodes using a flexible <a href="#dfn-target" class="internalDFN" data-link-type="dfn">target</a> mechanism, e.g. for all instances of a class. One focus area of SHACL is data validation. However, the same principles of describing data patterns in shapes can also be exploited for other purposes.
      <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">SHACL rules</a> build on SHACL to form a light-weight RDF vocabulary for the exchange of <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rules</a> that can be used to derive <a href="#dfn-inferred" class="internalDFN" data-link-type="dfn">inferred</a> RDF <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a> from existing <em>asserted</em> <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a>.
    </p>
    <p>
      The <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">SHACL rules</a> feature defined in this section includes a general framework using the properties such as <code>sh:rule</code> and <code>sh:condition</code>, plus an extension mechanism for specific <a href="#dfn-rule-type" class="internalDFN" data-link-type="dfn">rule types</a>. This document defines two such rule types: <a href="#dfn-triple-rules" class="internalDFN" data-link-type="dfn">Triple rules</a> and <a href="#dfn-sparql-rules" class="internalDFN" data-link-type="dfn">SPARQL rules</a>. Other documents, including SHACL JavaScript Extensions [<cite><a class="bibref" href="#bib-shacl-js">shacl-js</a></cite>], can define additional types of rules.
    </p>

    <section id="rules-examples" class="informative" typeof="bibo:Chapter" resource="#rules-examples" property="bibo:hasPart">
      <h3 id="h-rules-examples" resource="#h-rules-examples"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.1 </span>Examples of SHACL Rules</span>
      </h3>
      <p><em>This section is non-normative.</em></p>
      <p>
        The following example illustrates the use of a <a href="#dfn-triple-rules" class="internalDFN" data-link-type="dfn">triple rule</a> that adds an <code>rdf:type</code>
        <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triple</a> so that those <a href="#dfn-shacl-instance" class="internalDFN" data-link-type="dfn">SHACL instances</a> of <code>ex:Rectangle</code> where the
        <code>ex:width</code> equals the <code>ex:height</code> are also marked to be instances of <code>ex:Square</code>. The rule applies only to well-formed rectangles that <a href="#dfn-conformance" class="internalDFN" data-link-type="dfn">conform</a> to the <code>ex:Rectangle</code> <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a>, e.g. by having exactly one width and height, both integers.
      </p>
      <pre class="example-shapes" title="A rule to classify certain rectangles as squares">ex:Rectangle
	a rdfs:Class, sh:NodeShape ;
	rdfs:label "Rectangle" ;
	sh:property [
		sh:path ex:height ;
		sh:datatype xsd:integer ;
		sh:maxCount 1 ;
		sh:minCount 1 ;
		sh:name "height" ;
	] ;
	sh:property [
		sh:path ex:width ;
		sh:datatype xsd:integer ;
		sh:maxCount 1 ;
		sh:minCount 1 ;
		sh:name "width" ;
	] ;
	sh:rule [
		a sh:TripleRule ;
		sh:subject sh:this ;
		sh:predicate rdf:type ;
		sh:object ex:Square ;
		sh:condition ex:Rectangle ;
		sh:condition [
			sh:property [
				sh:path ex:width ;
				sh:equals ex:height ;
			] ;
		] ;
	] .</pre>
      <pre class="example-data">ex:InvalidRectangle
	a ex:Rectangle .

ex:NonSquareRectangle
	a ex:Rectangle ;
	ex:height 2 ;
	ex:width 3 .
	
ex:SquareRectangle
	a ex:Rectangle ;
	ex:height 4 ;
	ex:width 4 .</pre>
      <p>
        For the <a href="#dfn-data-graph" class="internalDFN" data-link-type="dfn">data graph</a> above, a SHACL rules engine will produce the following inferred triples:
      </p>
      <pre class="example-inferences">	ex:SquareRectangle rdf:type ex:Square .</pre>
      <p>
        No inferences will be made for <code>ex:NonSquareRectangle</code> because its width is not equal to its height. No inferences will be made for <code>ex:InvalidRectangle</code> because although it has equal width and height (namely none), it does not pass the <code>sh:condition</code> of being a well-formed rectangle.
      </p>
      <p>
        The following example illustrates a simple use case of a <a href="#dfn-sparql-rules" class="internalDFN" data-link-type="dfn">SPARQL rule</a> that applies to all instances of the class <code>ex:Rectangle</code> and computes the values of the <code>ex:area</code> property by multiplying the rectangle's width and height:
      </p>
      <pre class="example-shapes" title="A rule to compute the area of a Rectangle">ex:RectangleShape
	a sh:NodeShape ;
	sh:targetClass ex:Rectangle ;
	sh:property [
		sh:path ex:width ;
		sh:datatype xsd:integer ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
	] ;
	sh:property [
		sh:path ex:height ;
		sh:datatype xsd:integer ;
		sh:minCount 1 ;
		sh:maxCount 1 ;
	] .

ex:RectangleRulesShape
	a sh:NodeShape ;
	sh:targetClass ex:Rectangle ;
	sh:rule [
		a sh:SPARQLRule ;
		sh:prefixes ex: ;
		sh:construct """
			CONSTRUCT {
				$this ex:area ?area .
			}
			WHERE {
				$this ex:width ?width .
				$this ex:height ?height .
				BIND (?width * ?height AS ?area) .
			}
			""" ;
		sh:condition ex:RectangleShape ;    # Rule only applies to Rectangles that conform to ex:RectangleShape
	] ;
.</pre>
      <p>
        An engine that is capable of executing such rules uses the <a href="#dfn-target" class="internalDFN" data-link-type="dfn">target</a> statements associated with the <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shapes</a> in the <a href="#dfn-shapes-graph" class="internalDFN" data-link-type="dfn">shapes graph</a> to determine which rules need to be executed on which target nodes. For those target nodes that <a href="#dfn-conformance" class="internalDFN" data-link-type="dfn">conform</a> to any <a href="#condition">condition shapes</a>, it executes the provided CONSTRUCT queries to produce the inferred triples. During the execution of the query, the variable <code>this</code> has the current <a href="#dfn-focus-node" class="internalDFN" data-link-type="dfn">focus node</a> as <a href="#dfn-pre-binding" class="internalDFN" data-link-type="dfn">pre-bound</a> variable. For the following <a href="#dfn-data-graph" class="internalDFN" data-link-type="dfn">data graph</a>, the <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a> below would be produced.
      </p>
      <pre class="example-data">ex:ExampleRectangle
	a ex:Rectangle ;
	ex:width 7 ;
	ex:height 8 .

ex:InvalidRectangle    # Lacks a value for ex:height, so sh:condition is not met
	a ex:Rectangle ;
	ex:width 7 .</pre>
      <p>
        Inferred triples:
      </p>
      <pre class="example-inferences">	ex:ExampleRectangle ex:area 56 .</pre>
      <p>
        The following variation produces the same results as the <a href="#dfn-sparql-rules" class="internalDFN" data-link-type="dfn">SPARQL rule</a>, but uses a <a href="#dfn-triple-rules" class="internalDFN" data-link-type="dfn">Triple rule</a>. While not as expressive as CONSTRUCT-based rules, <a href="#dfn-triple-rules" class="internalDFN" data-link-type="dfn">Triple rules</a> are more declarative and may be executed on platforms that do not support SPARQL.
      </p>
      <pre class="example-shapes" title="A triple rule to compute the area of a Rectangle">ex:RectangleRulesShape
	a sh:NodeShape ;
	sh:targetClass ex:Rectangle ;
	sh:rule [
		a sh:TripleRule ;
		sh:subject sh:this ;
		sh:predicate ex:area ;    # Computes the values of the ex:area property at the focus nodes
		sh:object [
			ex:multiply ( [ sh:path ex:width ] [ sh:path ex:height ] ) ;
		] ;
		sh:condition ex:RectangleShape ;    # Rule only applies to Rectangles that conform to ex:RectangleShape
	] .</pre>
    </section>

    <section id="rules-syntax" typeof="bibo:Chapter" resource="#rules-syntax" property="bibo:hasPart">
      <h3 id="h-rules-syntax" resource="#h-rules-syntax"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.2 </span>General Syntax of SHACL Rules</span>
      </h3>
      <p>
        The <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of the property <code>sh:rule</code> at a <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> are called <dfn data-dfn-type="dfn" id="dfn-shacl-rules">SHACL rules</dfn>. SHACL has a flexible design in which multiple types of rules can be supported, including <a href="#dfn-triple-rules" class="internalDFN" data-link-type="dfn">Triple rules</a> and <a href="#dfn-sparql-rules" class="internalDFN" data-link-type="dfn">SPARQL rules</a>. Each <dfn data-dfn-type="dfn" id="dfn-rule-type">rule type</dfn> is identified by an <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRI</a> that is used as <code>rdf:type</code> of rules. Each rule type also defines <dfn data-dfn-type="dfn" id="dfn-execution-instructions">execution instructions</dfn> that can be implemented by rule engines.
      </p>
      <p class="syntax">
        <span data-syntax-rule="rule-type" id="syntax-rule-rule-type">Each <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">SHACL rule</a> has at least one <code>rdf:type</code> which is a <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRI</a>.</span>
      </p>
      <p>
        Rules can have multiple types, e.g. to provide instructions that work either in SPARQL or JavaScript, depending on the capabilities of the engine. The creator of such rules needs to make sure that such rules have consistent semantics. Rule <code>R</code> has <a href="#dfn-rule-type" class="internalDFN" data-link-type="dfn">rule type</a> <code>T</code> if <code>R</code> is a <a href="#dfn-shacl-instance" class="internalDFN" data-link-type="dfn">SHACL instance</a> of <code>T</code>.
      </p>
      <p>
        All rules may have the properties defined in the rest of this section.
      </p>

      <section id="condition" typeof="bibo:Chapter" resource="#condition" property="bibo:hasPart">
        <h4 id="h-condition" resource="#h-condition"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.2.1 </span>sh:condition</span>
        </h4>
        <p>
          A <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rule</a> may have values for the property <code>sh:condition</code> to specify <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shapes</a> that the <a href="#dfn-focus-node" class="internalDFN" data-link-type="dfn">focus nodes</a> must conform to before the rule gets executed.
        </p>
        <p class="syntax">
          <span data-syntax-rule="condition-node" id="syntax-rule-condition-node">The <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>sh:condition</code> at a <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rule</a> must be well-formed <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shapes</a>.</span>
        </p>
      </section>

      <section id="rules-order" typeof="bibo:Chapter" resource="#rules-order" property="bibo:hasPart">
        <h4 id="h-rules-order" resource="#h-rules-order"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.2.2 </span>sh:order</span>
        </h4>
        <p>
          Rules and shapes may specify its relative <dfn data-dfn-type="dfn" id="dfn-execution-order">execution order</dfn> as defined in this section.
        </p>
        <p class="syntax">
          <span data-syntax-rule="rule-order-maxCount" id="syntax-rule-rule-order-maxCount">Each <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rule</a> or <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> may have at most one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for the
						property <code>sh:order</code>.</span>
          <span data-syntax-rule="rule-order-datatype" id="syntax-rule-rule-order-datatype">The values of <code>sh:order</code> at <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rules</a> and <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shapes</a>
						are <a href="#dfn-literal" class="internalDFN" data-link-type="dfn">literals</a> with a <em>numeric</em> datatype such as <code>xsd:decimal</code>.</span>
        </p>
        <p>
          If unspecified, then the default <a href="#dfn-execution-order" class="internalDFN" data-link-type="dfn">execution order</a> is <code>0</code>. These values are used by a <a href="#dfn-shacl-rules-engine" class="internalDFN" data-link-type="dfn">rules engine</a> to determine the order of <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rules</a>. When the <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rules</a> associated with a <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> are executed, <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rules</a> with larger values will be executed after those with smaller values.
        </p>
        <pre class="example-shapes" title="Rule order example">ex:RuleOrderExampleShape
	a sh:NodeShape ;
	sh:targetClass ex:Person ;
	sh:rule [
		a sh:SPARQLRule ;
		rdfs:label "Infer uncles, i.e. male siblings of the parents of $this" ;
		sh:prefixes ex: ;
		sh:order 1 ;   # Will be evaluated before 2
		sh:construct """
			CONSTRUCT {
				$this ex:uncle ?uncle .
			}
			WHERE {
				$this ex:parent ?parent .
				?parent ex:sibling ?uncle .
				?uncle ex:gender ex:male .
			}
			"""
	] ;
	sh:rule [
		a sh:SPARQLRule ;
		rdfs:label "Infer cousins, i.e. the children of the uncles" ;
		sh:prefixes ex: ;
		sh:order 2 ;
		sh:construct """
			CONSTRUCT {
				$this ex:cousin ?cousin .
			}
			WHERE {
				$this ex:uncle ?uncle .
				?cousin ex:parent ?uncle .
			}
			"""
	] .</pre>
      </section>

      <section id="deactivated" typeof="bibo:Chapter" resource="#deactivated" property="bibo:hasPart">
        <h4 id="h-deactivated" resource="#h-deactivated"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.2.3 </span>sh:deactivated</span>
        </h4>
        <p>
          Rules may be <em>deactivated</em> by setting <code>sh:deactivated</code> to <code>true</code>. Deactivated rules are ignored by the rules engine.
        </p>
        <p class="syntax">
          <span data-syntax-rule="deactivated-maxCount" id="syntax-rule-deactivated-maxCount">Each <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rule</a> may have at most one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for the
						property <code>sh:deactivated</code>.</span>
          <span data-syntax-rule="deactivated-in" id="syntax-rule-deactivated-in">The <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>sh:deactivated</code> are either
						of the <code>xsd:boolean</code> literals <code>true</code> or <code>false</code>.</span>
        </p>
      </section>
    </section>

    <section id="Rules" typeof="bibo:Chapter" resource="#Rules" property="bibo:hasPart">
      <h3 id="h-rules-1" resource="#h-rules-1"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.3 </span>The sh:Rules Entailment Regime</span>
      </h3>
      <p>
        SHACL defines the property <a href="https://www.w3.org/TR/shacl/#shacl-rdfs"><code>sh:entailment</code></a> to link a <a href="#dfn-shapes-graph" class="internalDFN" data-link-type="dfn">shapes graph</a> with <em>entailment regimes</em>. The <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRI</a> <code>sh:Rules</code> represents the <dfn data-dfn-type="dfn" id="dfn-shacl-rules-entailment-regime">SHACL rules entailment regime</dfn>. In the following example, the shapes graph indicates to a SHACL validation engine that the SHACL rules inside of the <a href="#dfn-shapes-graph" class="internalDFN" data-link-type="dfn">shapes graph</a> need to be executed prior to starting the validation.
      </p>
      <pre class="example-shapes">&lt;http://example.org/my-shapes&gt;
	a owl:Ontology ;
	sh:entailment sh:Rules .</pre>
      <p>
        Following the general policy for SHACL, validation engines that do <em>not</em> support the <a href="#dfn-shacl-rules-entailment-regime" class="internalDFN" data-link-type="dfn">SHACL rules entailment regime</a>
        <em class="rfc2119" title="MUST">MUST</em> signal a <a href="#dfn-failure" class="internalDFN" data-link-type="dfn">failure</a> if this <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triple</a> is present. Validation engines that do support the <a href="#dfn-shacl-rules-entailment-regime" class="internalDFN" data-link-type="dfn">SHACL rules entailment regime</a> execute the rules following the
        <a href="#rules-execution">rules execution instructions</a> prior to performing the actual validation.
      </p>
    </section>

    <section id="rules-execution" typeof="bibo:Chapter" resource="#rules-execution" property="bibo:hasPart">
      <h3 id="h-rules-execution" resource="#h-rules-execution"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.4 </span>General Execution Instructions for SHACL Rules</span>
      </h3>
      <p>
        A <dfn data-dfn-type="dfn" id="dfn-shacl-rules-engine">SHACL rules engine</dfn> is a computer procedure that takes as input a <a href="#dfn-data-graph" class="internalDFN" data-link-type="dfn">data graph</a> and a <a href="#dfn-shapes-graph" class="internalDFN" data-link-type="dfn">shapes graph</a> and is capable of adding <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a> to the <a href="#dfn-data-graph" class="internalDFN" data-link-type="dfn">data graph</a>. The new <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a> that are produced by a rules engine are called the <dfn data-dfn-type="dfn" id="dfn-inferred">inferred</dfn> triples.
      </p>
      <p>
        Note that, from a logical perspective, the <a href="#dfn-data-graph" class="internalDFN" data-link-type="dfn">data graph</a> will be <em>modified</em> if <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a> get inferred. This means that rules can trigger after other triples have been inferred. However, in cases where the original data should not be modified, implementations may construct a logical <a href="#dfn-data-graph" class="internalDFN" data-link-type="dfn">data graph</a> that has the original data as one subgraph and a dedicated inferences graph as another subgraph, and where the inferred triples get added to the inferences graph only.
      </p>
      <p>
        In order to count as a SHACL rules engine, an implementation must be capable of <a href="#dfn-inferred" class="internalDFN" data-link-type="dfn">inferring</a> <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a> according to the following procedure (given in pseudo-code), or a different algorithm as long as the result is the same as specified. Note that this algorithm only covers a single "iteration" over all rules, without prescribing the behavior if the same rule needs to be applied multiple times after other rules have fired. The latter is left to future work.
      </p>
      <pre>	for each <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> <code>S</code> in the <a href="#dfn-shapes-graph" class="internalDFN" data-link-type="dfn">shapes graph</a>, ordered by <a href="#dfn-execution-order" class="internalDFN" data-link-type="dfn">execution order</a> {
		for each non-deactivated <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rule</a> <code>R</code> in the <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a>, ordered by <a href="#dfn-execution-order" class="internalDFN" data-link-type="dfn">execution order</a> {
			for each <a href="#dfn-target" class="internalDFN" data-link-type="dfn">target</a> node <code>T</code> of <code>S</code> that <a href="#dfn-conformance" class="internalDFN" data-link-type="dfn">conforms</a> to all <a href="#condition">conditions</a> of <code>R</code> {
				execute <code>R</code> using <code>T</code> as <a href="#dfn-focus-node" class="internalDFN" data-link-type="dfn">focus node</a> following the <a href="#dfn-execution-instructions" class="internalDFN" data-link-type="dfn">execution instructions</a> of its <a href="#dfn-rule-type" class="internalDFN" data-link-type="dfn">rule types</a>
			}
		}
	}</pre>
      <p>
        The <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a> that are inferred by a <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rule</a> do not <em>immediately</em> become part of the <a href="#dfn-data-graph" class="internalDFN" data-link-type="dfn">data graph</a>, i.e. the <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a> produced by one <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rule</a> can not always be queried by other <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rules</a>. These policies reduce the likelihood of race conditions and better support parallel execution.
      </p>
      <ul>
        <li>
          If two <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shapes</a> have the same <a href="#dfn-execution-order" class="internalDFN" data-link-type="dfn">execution order</a> then their newly inferred <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a> are not visible to each other.
        </li>
        <li>
          If two <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rules</a> have the same <a href="#dfn-execution-order" class="internalDFN" data-link-type="dfn">execution order</a> then their newly inferred <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a> are not visible to each other.
        </li>
        <li>
          If the same <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rule</a> is executed on multiple target nodes then the newly inferred <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a> are not visible to the other target nodes.
        </li>
      </ul>
      <p>
        If a <a href="#dfn-shacl-rules-engine" class="internalDFN" data-link-type="dfn">rules engine</a> is not able to execute a given <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rule</a> because it does not support any of the <a href="#dfn-rule-type" class="internalDFN" data-link-type="dfn">rule types</a> of the <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rule</a>, then it reports a <a href="#dfn-failure" class="internalDFN" data-link-type="dfn">failure</a>.
      </p>
      <p>
        At no time are inferred triples visible to the <a href="#dfn-shapes-graph" class="internalDFN" data-link-type="dfn">shapes graph</a>, i.e. it is impossible for rules to modify the definitions of rules or shapes.
      </p>
    </section>

    <section id="TripleRule" typeof="bibo:Chapter" resource="#TripleRule" property="bibo:hasPart">
      <h3 id="h-triplerule" resource="#h-triplerule"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.5 </span>Triple Rules</span>
      </h3>
      <p>
        This section defines a <a href="#dfn-rule-type" class="internalDFN" data-link-type="dfn">rule type</a> called <dfn data-dfn-type="dfn" id="dfn-triple-rules">triple rules</dfn>, identified by the <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRI</a> <code>sh:TripleRule</code>.
        <a href="#dfn-triple-rules" class="internalDFN" data-link-type="dfn">Triple rules</a> have the following properties:
      </p>
      <p>
      </p>
      <table class="term-table">
        <tbody>
          <tr>
            <th>Property</th>
            <th>Summary and Syntax Rules</th>
          </tr>
          <tr>
            <td><code>sh:subject</code></td>
            <td>
              The <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a> used to compute the <a href="#dfn-subject" class="internalDFN" data-link-type="dfn">subjects</a> of the <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a>.
              <span data-syntax-rule="TripleRule-subject" id="syntax-rule-TripleRule-subject">Each <a href="#dfn-triple-rules" class="internalDFN" data-link-type="dfn">triple rule</a> must have exactly one
							<a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> of the property <code>sh:subject</code> (which must be a well-formed <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a>).
							</span>
            </td>
          </tr>
          <tr>
            <td><code>sh:predicate</code></td>
            <td>
              The <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a> used to compute the <a href="#dfn-predicate" class="internalDFN" data-link-type="dfn">predicates</a> of the <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a>.
              <span data-syntax-rule="TripleRule-predicate" id="syntax-rule-TripleRule-predicate">Each <a href="#dfn-triple-rules" class="internalDFN" data-link-type="dfn">triple rule</a> must have exactly one
							<a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> of the property <code>sh:predicate</code> (which must be a well-formed <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a>).
							</span>
            </td>
          </tr>
          <tr>
            <td><code>sh:object</code></td>
            <td>
              The <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a> used to compute the <a href="#dfn-object" class="internalDFN" data-link-type="dfn">objects</a> of the <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a>.
              <span data-syntax-rule="TripleRule-object" id="syntax-rule-TripleRule-object">Each <a href="#dfn-triple-rules" class="internalDFN" data-link-type="dfn">triple rule</a> must have exactly one
							<a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> of the property <code>sh:object</code> (which must be a well-formed <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a>).
							</span>
            </td>
          </tr>
        </tbody>
      </table>
      <div class="def def-text">
        <div class="def-header">EXECUTION OF TRIPLE RULES</div>
        <div class="def-text-body">
          Let <code>S</code>, <code>P</code> and <code>O</code> be the sets of <a href="#dfn-node" class="internalDFN" data-link-type="dfn">nodes</a> produced by evaluating the <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expressions</a> that are the values of <code>sh:subject</code>, <code>sh:predicate</code> and <code>sh:object</code> respectively at the <a href="#dfn-triple-rules" class="internalDFN" data-link-type="dfn">triple rule</a>. For each combination of members <code>s</code> of <code>S</code>, <code>p</code> of <code>P</code> and
          <code>o</code> of <code>O</code>, <a href="#dfn-inferred" class="internalDFN" data-link-type="dfn">infer</a> a <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triple</a> with <a href="#dfn-subject" class="internalDFN" data-link-type="dfn">subject</a> <code>s</code>,
          <a href="#dfn-predicate" class="internalDFN" data-link-type="dfn">predicate</a> <code>p</code> and <a href="#dfn-object" class="internalDFN" data-link-type="dfn">object</a> <code>o</code>.
        </div>
      </div>
    </section>

    <section id="SPARQLRule" typeof="bibo:Chapter" resource="#SPARQLRule" property="bibo:hasPart">
      <h3 id="h-sparqlrule" resource="#h-sparqlrule"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.6 </span>SPARQL Rules</span>
      </h3>
      <p>
        This section defines a <a href="#dfn-rule-type" class="internalDFN" data-link-type="dfn">rule type</a> called <dfn data-dfn-type="dfn" id="dfn-sparql-rules">SPARQL rules</dfn>, identified by the <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRI</a> <code>sh:SPARQLRule</code>.
        <a href="#dfn-sparql-rules" class="internalDFN" data-link-type="dfn">SPARQL rules</a> have the following properties:
      </p>
      <p>
      </p>
      <table class="term-table">
        <tbody>
          <tr>
            <th>Property</th>
            <th>Summary and Syntax Rules</th>
          </tr>
          <tr>
            <td><code>sh:construct</code></td>
            <td>
              The SPARQL CONSTRUCT query.
              <span data-syntax-rule="construct-count" id="syntax-rule-construct-count"><a href="#dfn-sparql-rules" class="internalDFN" data-link-type="dfn">SPARQL rules</a> must have exactly one
							<a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for the property <code>sh:construct</code>.</span>
              <span data-syntax-rule="construct-datatype" id="syntax-rule-construct-datatype">The values of <code>sh:construct</code>
							are <a href="#dfn-literal" class="internalDFN" data-link-type="dfn">literals</a> with datatype <code>xsd:string</code>.</span>
            </td>
          </tr>
          <tr>
            <td><code>sh:prefixes</code></td>
            <td>
              The prefixes to use to turn the <code>sh:construct</code> into a SPARQL query.
              <a href="#dfn-sparql-rules" class="internalDFN" data-link-type="dfn">SPARQL rules</a> may use the property <code>sh:prefixes</code> to declare a dependency on prefixes based on the mechanism defined in <a href="https://www.w3.org/TR/shacl/#sparql-prefixes">Prefix Declarations for SPARQL Queries</a> from the SHACL specification [<cite><a class="bibref" href="#bib-shacl">shacl</a></cite>]. This mechanism allows users to abbreviate URIs in the <code>sh:construct</code> strings.
            </td>
          </tr>
        </tbody>
      </table>
      <div class="def def-text">
        <div class="def-header">EXECUTION OF SPARQL RULES</div>
        <div class="def-text-body">
          Let <code>Q</code> be the SPARQL CONSTRUCT query derived from the values of the properties
          <code>sh:construct</code> and <code>sh:prefixes</code> of the <a href="#dfn-sparql-rules" class="internalDFN" data-link-type="dfn">SPARQL rule</a> in the <a href="#dfn-shapes-graph" class="internalDFN" data-link-type="dfn">shapes graph</a>. For each <a href="#dfn-focus-node" class="internalDFN" data-link-type="dfn">focus node</a>, execute the query <code>Q</code>
          <a href="#dfn-pre-binding" class="internalDFN" data-link-type="dfn">pre-binding</a> the variable <code>this</code> to the <a href="#dfn-focus-node" class="internalDFN" data-link-type="dfn">focus node</a>, and <a href="#dfn-inferred" class="internalDFN" data-link-type="dfn">infer</a> the constructed <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triples</a>.
        </div>
      </div>
    </section>
  </section>

  <section id="syntax-rules" class="appendix" typeof="bibo:Chapter" resource="#syntax-rules" property="bibo:hasPart">
    <!--OddPage-->
    <h2 id="h-syntax-rules" resource="#h-syntax-rules"><span property="xhv:role" resource="xhv:heading"><span class="secno">A. </span>Summary of Syntax Rules from this Document</span>
    </h2>
    <p>
      This section enumerates all normative syntax rules from this document. This section is automatically generated from other parts of this spec and hyperlinks are provided back into the prose if the context of the rule in unclear. Nodes that violate these rules in a shapes graph are ill-formed.
    </p>
    <table class="term-table" id="syntax-rules-table">
      <tbody>
        <tr>
          <th>Syntax Rule Id</th>
          <th>Syntax Rule Text</th>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-target-nodeKind">target-nodeKind</a></td>
          <td>The <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>sh:target</code> at a <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> are
            <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRIs</a> or <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">blank nodes</a>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-SPARQLTarget-select-count">SPARQLTarget-select-count</a></td>
          <td><a href="#dfn-sparql-based-targets" class="internalDFN" data-link-type="dfn">SPARQL-based targets</a> have exactly one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for the property <code>sh:select</code>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-SPARQLTarget-prefixes-nodeKind">SPARQLTarget-prefixes-nodeKind</a></td>
          <td><a href="#dfn-sparql-based-targets" class="internalDFN" data-link-type="dfn">SPARQL-based targets</a> may have <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> for the property <code>sh:prefixes</code> and these values are <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRIs</a> or <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">blank nodes</a>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-SPARQLTarget-select-sparql">SPARQLTarget-select-sparql</a></td>
          <td>Using the <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>sh:prefixes</code> as defined by
            <a href="https://www.w3.org/TR/shacl/#sparql-prefixes">5.2.1 Prefix Declarations for SPARQL Queries</a>, the <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>sh:select</code> must be valid SPARQL 1.1 SELECT queries with a single result variable <code>this</code>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-SPARQLTarget-ask-count">SPARQLTarget-ask-count</a></td>
          <td><a href="#dfn-sparql-based-targets" class="internalDFN" data-link-type="dfn">SPARQL-based targets</a> have at most one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for the property <code>sh:ask</code>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-resultAnnotation-nodeKind">resultAnnotation-nodeKind</a></td>
          <td>The <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>sh:resultAnnotation</code> are called <a href="#dfn-result-annotations" class="internalDFN" data-link-type="dfn">result annotations</a> and are either <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRIs</a> or <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">blank nodes</a></td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-annotationProperty">annotationProperty</a></td>
          <td>Each <a href="#dfn-result-annotations" class="internalDFN" data-link-type="dfn">result annotation</a> has exactly one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for the property <code>sh:annotationProperty</code> and this value is an <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRI</a>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-annotationVarName">annotationVarName</a></td>
          <td>Each <a href="#dfn-result-annotations" class="internalDFN" data-link-type="dfn">result annotation</a> has at most 1 <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for the property <code>sh:annotationVarName</code> and this <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> is <a href="#dfn-literal" class="internalDFN" data-link-type="dfn">literal</a> with
            <a href="#dfn-datatype" class="internalDFN" data-link-type="dfn">datatype</a> <code>xsd:string</code>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-returnType-maxCount">returnType-maxCount</a></td>
          <td>A function has at most one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for <code>sh:returnType</code>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-returnType-nodeKind">returnType-nodeKind</a></td>
          <td>The values of <code>sh:returnType</code> are <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRIs</a>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-SPARQLFunction-query">SPARQLFunction-query</a></td>
          <td><a href="#dfn-sparql-based-functions" class="internalDFN" data-link-type="dfn">SPARQL-based functions</a> have exactly one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for either <code>sh:ask</code> or <code>sh:select</code>. The <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of these properties are strings that can be parsed into SPARQL queries of type ASK (for <code>sh:ask</code>) or SELECT (for <code>sh:select</code>) using the SHACL-SPARQL <a href="https://www.w3.org/TR/shacl/#sparql-prefixes">prefix declaration mechanism</a>. SELECT queries return exactly one result variable and do not use the <code>SELECT *</code> syntax.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-node-expressions-recursion">node-expressions-recursion</a></td>
          <td>A <code>node expression</code> cannot recursively have itself as a "nested" node expression, e.g. as <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> of <code>sh:nodes</code>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-FilterShapeExpression">FilterShapeExpression</a></td>
          <td>A <a href="#dfn-filter-shape-expression" class="internalDFN" data-link-type="dfn">filter shape expression</a> is a <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">blank node</a> with exactly one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for <code>sh:filterShape</code> (which is a well-formed <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a>) and exactly one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for <code>sh:nodes</code> (which is a well-formed <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a>).</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-FunctionExpression">FunctionExpression</a></td>
          <td>A <a href="#dfn-function-expression" class="internalDFN" data-link-type="dfn">function expression</a> is a <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">blank node</a> that does not fulfill any of the syntax rules of the other node expression types and which is the <a href="#dfn-subject" class="internalDFN" data-link-type="dfn">subject</a> of exactly one <a href="#dfn-triple" class="internalDFN" data-link-type="dfn">triple</a> <code>T</code> where the <a href="#dfn-object" class="internalDFN" data-link-type="dfn">object</a> is a well-formed <a href="#dfn-shacl-list" class="internalDFN" data-link-type="dfn">SHACL list</a>, and each <a href="#dfn-member" class="internalDFN" data-link-type="dfn">member</a> of that list is a well-formed <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-PathExpression">PathExpression</a></td>
          <td>A <a href="#dfn-path-expression" class="internalDFN" data-link-type="dfn">path expression</a> is a <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">blank node</a> with exactly one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> of the property <code>sh:path</code> (which are well-formed <a href="#dfn-property-path" class="internalDFN" data-link-type="dfn">property paths</a>) and at most one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for <code>sh:nodes</code> (which is a well-formed <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a>).</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-intersection">intersection</a></td>
          <td>An <a href="#dfn-intersection-expression" class="internalDFN" data-link-type="dfn">intersection expression</a> is a <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">blank node</a> with exactly one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for the property <code>sh:intersection</code> which is a well-formed <a href="#dfn-shacl-list" class="internalDFN" data-link-type="dfn">SHACL list</a> with at least two <a href="#dfn-member" class="internalDFN" data-link-type="dfn">members</a> (which are well-formed node expressions).</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-union">union</a></td>
          <td>A <a href="#dfn-union-expression" class="internalDFN" data-link-type="dfn">union expression</a> is a <a href="#dfn-blank-node" class="internalDFN" data-link-type="dfn">blank node</a> with exactly one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for the property <code>sh:union</code> which is a well-formed <a href="#dfn-shacl-list" class="internalDFN" data-link-type="dfn">SHACL list</a> with at least two <a href="#dfn-member" class="internalDFN" data-link-type="dfn">members</a> (which are well-formed node expressions).</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-expression-scope">expression-scope</a></td>
          <td>The <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>sh:expression</code> at a
            <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> must be well-formed <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expressions</a>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-rule-type">rule-type</a></td>
          <td>Each <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">SHACL rule</a> has at least one <code>rdf:type</code> which is a <a href="#dfn-iri" class="internalDFN" data-link-type="dfn">IRI</a>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-condition-node">condition-node</a></td>
          <td>The <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>sh:condition</code> at a <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rule</a> must be well-formed <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shapes</a>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-rule-order-maxCount">rule-order-maxCount</a></td>
          <td>Each <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rule</a> or <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shape</a> may have at most one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for the property <code>sh:order</code>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-rule-order-datatype">rule-order-datatype</a></td>
          <td>The values of <code>sh:order</code> at <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rules</a> and <a href="#dfn-shape" class="internalDFN" data-link-type="dfn">shapes</a> are <a href="#dfn-literal" class="internalDFN" data-link-type="dfn">literals</a> with a <em>numeric</em> datatype such as <code>xsd:decimal</code>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-deactivated-maxCount">deactivated-maxCount</a></td>
          <td>Each <a href="#dfn-shacl-rules" class="internalDFN" data-link-type="dfn">rule</a> may have at most one <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for the property <code>sh:deactivated</code>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-deactivated-in">deactivated-in</a></td>
          <td>The <a href="#dfn-value" class="internalDFN" data-link-type="dfn">values</a> of <code>sh:deactivated</code> are either of the <code>xsd:boolean</code> literals <code>true</code> or <code>false</code>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-TripleRule-subject">TripleRule-subject</a></td>
          <td>Each <a href="#dfn-triple-rules" class="internalDFN" data-link-type="dfn">triple rule</a> must have exactly one
            <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> of the property <code>sh:subject</code> (which must be a well-formed <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a>).
          </td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-TripleRule-predicate">TripleRule-predicate</a></td>
          <td>Each <a href="#dfn-triple-rules" class="internalDFN" data-link-type="dfn">triple rule</a> must have exactly one
            <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> of the property <code>sh:predicate</code> (which must be a well-formed <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a>).
          </td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-TripleRule-object">TripleRule-object</a></td>
          <td>Each <a href="#dfn-triple-rules" class="internalDFN" data-link-type="dfn">triple rule</a> must have exactly one
            <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> of the property <code>sh:object</code> (which must be a well-formed <a href="#dfn-node-expressions" class="internalDFN" data-link-type="dfn">node expression</a>).
          </td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-construct-count">construct-count</a></td>
          <td><a href="#dfn-sparql-rules" class="internalDFN" data-link-type="dfn">SPARQL rules</a> must have exactly one
            <a href="#dfn-value" class="internalDFN" data-link-type="dfn">value</a> for the property <code>sh:construct</code>.</td>
        </tr>
        <tr class="syntax-rule-tr">
          <td class="#syntax-rule-id&quot;"><a class="syntax-rule-id-a" href="#syntax-rule-construct-datatype">construct-datatype</a></td>
          <td>The values of <code>sh:construct</code> are <a href="#dfn-literal" class="internalDFN" data-link-type="dfn">literals</a> with datatype <code>xsd:string</code>.</td>
        </tr>
      </tbody>
    </table>
  </section>

  <section id="security" class="appendix informative" typeof="bibo:Chapter" resource="#security" property="bibo:hasPart">
    <!--OddPage-->
    <h2 id="h-security" resource="#h-security"><span property="xhv:role" resource="xhv:heading"><span class="secno">B. </span>Security and Privacy Considerations</span>
    </h2>
    <p><em>This section is non-normative.</em></p>
    <p>
      The features defined in this document share certain security and privacy considerations with those
      <a href="https://www.w3.org/TR/shacl/#security">mentioned</a> in [<cite><a class="bibref" href="#bib-shacl">shacl</a></cite>]. The general advice is for users to only use trusted and controlled shape graphs.
    </p>
  </section>

  <section id="ack" class="appendix informative" typeof="bibo:Chapter" resource="#ack" property="bibo:hasPart">
    <!--OddPage-->
    <h2 id="h-ack" resource="#h-ack"><span property="xhv:role" resource="xhv:heading"><span class="secno">C. </span>Acknowledgements</span>
    </h2>
    <p><em>This section is non-normative.</em></p>
    <p>
      Many people contributed to this document, including members of the RDF Data Shapes Working Group. The sections <a href="#targets" class="sec-ref"><span class="secno">3.</span> <span class="sec-title">Custom Targets</span></a>, <a href="#sparql-constraints-annotations" class="sec-ref"><span class="secno">4.</span> <span class="sec-title">Annotation Properties</span></a> and
      <a href="#functions" class="sec-ref"><span class="secno">5.</span> <span class="sec-title">SHACL Functions</span></a> had been part of earlier drafts of the main SHACL specification [<cite><a class="bibref" href="#bib-shacl">shacl</a></cite>] but were moved out in part due to time constraints in the Working Group. Dimitris Kontokostas was the main contributor to the <a href="#sparql-constraints-annotations" class="sec-ref"><span class="secno">4.</span> <span class="sec-title">Annotation Properties</span></a> section.
    </p>
  </section>


  <section id="references" class="appendix" typeof="bibo:Chapter" resource="#references" property="bibo:hasPart">
    <!--OddPage-->
    <h2 id="h-references" resource="#h-references"><span property="xhv:role" resource="xhv:heading"><span class="secno">D. </span>References</span>
    </h2>

    <section id="normative-references" typeof="bibo:Chapter" resource="#normative-references" property="bibo:hasPart">
      <h3 id="h-normative-references" resource="#h-normative-references"><span property="xhv:role" resource="xhv:heading"><span class="secno">D.1 </span>Normative references</span>
      </h3>
      <dl class="bibliography" resource=""><dt id="bib-RFC2119">[RFC2119]</dt>
        <dd><a href="https://tools.ietf.org/html/rfc2119" property="dc:requires"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner. IETF. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119" property="dc:requires">https://tools.ietf.org/html/rfc2119</a>
        </dd><dt id="bib-rdf11-concepts">[rdf11-concepts]</dt>
        <dd><a href="https://www.w3.org/TR/rdf11-concepts/" property="dc:requires"><cite>RDF 1.1 Concepts and Abstract Syntax</cite></a>. Richard Cyganiak; David Wood; Markus Lanthaler. W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/rdf11-concepts/" property="dc:requires">https://www.w3.org/TR/rdf11-concepts/</a>
        </dd><dt id="bib-shacl">[shacl]</dt>
        <dd><a href="https://www.w3.org/TR/shacl/" property="dc:requires"><cite>Shapes Constraint Language (SHACL)</cite></a>. Holger Knublauch; Dimitris Kontokostas. W3C. 11 April 2017. W3C Candidate Recommendation. URL: <a href="https://www.w3.org/TR/shacl/" property="dc:requires">https://www.w3.org/TR/shacl/</a>
        </dd><dt id="bib-sparql11-query">[sparql11-query]</dt>
        <dd><a href="https://www.w3.org/TR/sparql11-query/" property="dc:requires"><cite>SPARQL 1.1 Query Language</cite></a>. Steven Harris; Andy Seaborne. W3C. 21 March 2013. W3C Recommendation. URL: <a href="https://www.w3.org/TR/sparql11-query/" property="dc:requires">https://www.w3.org/TR/sparql11-query/</a>
        </dd><dt id="bib-turtle">[turtle]</dt>
        <dd><a href="https://www.w3.org/TR/turtle/" property="dc:requires"><cite>RDF 1.1 Turtle</cite></a>. Eric Prud'hommeaux; Gavin Carothers. W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/turtle/" property="dc:requires">https://www.w3.org/TR/turtle/</a>
        </dd>
      </dl>
    </section>

    <section id="informative-references" typeof="bibo:Chapter" resource="#informative-references" property="bibo:hasPart">
      <h3 id="h-informative-references" resource="#h-informative-references"><span property="xhv:role" resource="xhv:heading"><span class="secno">D.2 </span>Informative references</span>
      </h3>
      <dl class="bibliography" resource=""><dt id="bib-shacl-js">[shacl-js]</dt>
        <dd><a href="https://www.w3.org/TR/shacl-js/" property="dc:references"><cite>SHACL JavaScript Extensions</cite></a>. Holger Knublauch; Pano Maria. W3C. W3C Working Group Note. URL: <a href="https://www.w3.org/TR/shacl-js/" property="dc:references">https://www.w3.org/TR/shacl-js/</a>
        </dd>
      </dl>
    </section>
  </section>
  <p role="navigation" id="back-to-top"><a href="#toc"><abbr title="Back to Top">↑</abbr></a></p>
  <script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
</body>
</html>